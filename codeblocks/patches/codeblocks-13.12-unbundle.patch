From e0d6b2146dc6f60565099262c4295148a35c3e53 Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Wed, 13 May 2009 10:21:19 +0200
Subject: [PATCH 01/38] add check for tinyxml into configure

---
 configure.ac | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/configure.ac b/configure.ac
index dfcdc20..9997857 100644
--- a/configure.ac
+++ b/configure.ac
@@ -63,9 +63,18 @@ AC_SEARCH_LIBS(gzopen, z, [HAVE_ZLIB=yes], [HAVE_ZLIB=no])
 LIBS=$save_LIBS
 AC_SEARCH_LIBS(BZ2_bzopen, bz2, [HAVE_BZIP2=yes], [HAVE_BZIP2=no])
 LIBS=$save_LIBS
+save_CC=$CC
+save_CPP=$CPP
+CC=$CXX
+CPP=$CXXCPP
+AC_CHECK_HEADER(tinyxml.h, [HAVE_TINYXML=yes], [HAVE_TINYXML=no])
+CC=$save_CC
+CPP=$save_CPP
+
 
 AM_CONDITIONAL([HAVE_ZLIB], [test "$HAVE_ZLIB" = yes])
 AM_CONDITIONAL([HAVE_BZIP2], [test "$HAVE_BZIP2" = yes])
+AM_CONDITIONAL([HAVE_TINYXML], [test "$HAVE_TINYXML" = yes])
 
 dnl versioning info for libtool
 dnl Note this is the ABI version which is not the same as our actual library version
-- 
1.9.0


From 0e6c5bf36864b8c2f061911ddbf4708653c32e4b Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Wed, 13 May 2009 16:53:29 +0200
Subject: [PATCH 02/38] move tinywxuni.h header from tinyxml into sdk

---
 src/include/Makefile.am                                   |  1 +
 src/include/tinywxuni.h                                   | 15 +++++++++++++++
 src/include/tinyxml/Makefile.am                           |  2 +-
 src/include/tinyxml/tinywxuni.h                           | 15 ---------------
 src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp |  2 +-
 .../contrib/lib_finder/librarydetectionmanager.cpp        |  2 +-
 src/plugins/contrib/wxSmith/wxsversionconverter.cpp       |  2 +-
 src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdata.cpp  |  2 +-
 .../contrib/wxSmith/wxwidgets/wxwidgetsresfactory.cpp     |  2 +-
 src/sdk/configmanager.cpp                                 |  2 +-
 src/sdk/globals.cpp                                       |  2 +-
 src/sdk/projectlayoutloader.cpp                           |  2 +-
 src/sdk/projectloader.cpp                                 |  2 +-
 src/sdk/workspaceloader.cpp                               |  2 +-
 src/tools/cb_share_config/mainframe.cpp                   |  2 +-
 15 files changed, 28 insertions(+), 27 deletions(-)
 create mode 100644 src/include/tinywxuni.h
 delete mode 100644 src/include/tinyxml/tinywxuni.h

diff --git a/src/include/Makefile.am b/src/include/Makefile.am
index 6f195ab..f7d7382 100644
--- a/src/include/Makefile.am
+++ b/src/include/Makefile.am
@@ -127,6 +127,7 @@ ALLHEADERS = annoyingdialog.h \
 				selecttargetdlg.h \
 				settings.h \
 				templatemanager.h \
+				tinywxuni.h \
 				toolsmanager.h \
 				uservarmanager.h \
 				virtualbuildtargetsdlg.h \
diff --git a/src/include/tinywxuni.h b/src/include/tinywxuni.h
new file mode 100644
index 0000000..b9433cc
--- /dev/null
+++ b/src/include/tinywxuni.h
@@ -0,0 +1,15 @@
+#ifndef TINYWXUNI_H
+#define TINYWXUNI_H
+
+class wxString;
+class TiXmlDocument;
+
+namespace TinyXML
+{
+    bool           LoadDocument(const wxString& filename, TiXmlDocument *doc);
+    TiXmlDocument* LoadDocument(const wxString& filename);
+
+    bool SaveDocument(const wxString& filename, TiXmlDocument* doc);
+}
+
+#endif
diff --git a/src/include/tinyxml/Makefile.am b/src/include/tinyxml/Makefile.am
index a1ec926..c22e938 100644
--- a/src/include/tinyxml/Makefile.am
+++ b/src/include/tinyxml/Makefile.am
@@ -1,3 +1,3 @@
 sdkdir=$(includedir)/codeblocks/tinyxml
 
-sdk_HEADERS = tinyxml.h tinywxuni.h tinystr.h
+sdk_HEADERS = tinystr.h tinyxml.h
diff --git a/src/include/tinyxml/tinywxuni.h b/src/include/tinyxml/tinywxuni.h
deleted file mode 100644
index b9433cc..0000000
--- a/src/include/tinyxml/tinywxuni.h
+++ /dev/null
@@ -1,15 +0,0 @@
-#ifndef TINYWXUNI_H
-#define TINYWXUNI_H
-
-class wxString;
-class TiXmlDocument;
-
-namespace TinyXML
-{
-    bool           LoadDocument(const wxString& filename, TiXmlDocument *doc);
-    TiXmlDocument* LoadDocument(const wxString& filename);
-
-    bool SaveDocument(const wxString& filename, TiXmlDocument* doc);
-}
-
-#endif
diff --git a/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp b/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp
index a08f1f2..edeb044 100644
--- a/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp
+++ b/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp
@@ -47,7 +47,7 @@
 
 #include <wx/tokenzr.h>
 #include "tinyxml/tinyxml.h"
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 
 #include "BrowseTrackerLayout.h"
 #include "BrowseMarks.h"
diff --git a/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp b/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp
index 886bbb7..a58776f 100644
--- a/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp
+++ b/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp
@@ -22,7 +22,7 @@
 */
 
 #include <tinyxml/tinyxml.h>
-#include <tinyxml/tinywxuni.h>
+#include <tinywxuni.h>
 
 #include <wx/arrstr.h>
 #include <wx/dir.h>
diff --git a/src/plugins/contrib/wxSmith/wxsversionconverter.cpp b/src/plugins/contrib/wxSmith/wxsversionconverter.cpp
index b03ceaa..8c2ca85 100644
--- a/src/plugins/contrib/wxSmith/wxsversionconverter.cpp
+++ b/src/plugins/contrib/wxSmith/wxsversionconverter.cpp
@@ -26,7 +26,7 @@
 
 #include <globals.h>
 #include <wx/string.h>
-#include <tinyxml/tinywxuni.h>
+#include <tinywxuni.h>
 
 // TODO: This is same as in wxsproject.h, make one set instead of two
 namespace
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdata.cpp b/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdata.cpp
index bd87a9b..51a6cb1 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdata.cpp
+++ b/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdata.cpp
@@ -31,7 +31,7 @@
 #include <globals.h>
 #include <logmanager.h>
 #include <wx/clipbrd.h>
-#include <tinyxml/tinywxuni.h>
+#include <tinywxuni.h>
 
 #if defined(__WXMSW__) && defined(LoadImage)
     // Fix Windows winuser.h Header define of LoadImage.
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/wxwidgetsresfactory.cpp b/src/plugins/contrib/wxSmith/wxwidgets/wxwidgetsresfactory.cpp
index 854602d..7f76bc3 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/wxwidgetsresfactory.cpp
+++ b/src/plugins/contrib/wxSmith/wxwidgets/wxwidgetsresfactory.cpp
@@ -31,7 +31,7 @@
 #include "../wxsmith.h"
 
 #include <wx/choicdlg.h>
-#include <tinyxml/tinywxuni.h>
+#include <tinywxuni.h>
 #include <sqplus.h>
 #include <sc_base_types.h>
 
diff --git a/src/sdk/configmanager.cpp b/src/sdk/configmanager.cpp
index 61e6123..cc71f09 100644
--- a/src/sdk/configmanager.cpp
+++ b/src/sdk/configmanager.cpp
@@ -47,7 +47,7 @@
 #include <CoreFoundation/CFURL.h>
 #endif
 
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 #include <stdlib.h>
 
 template<> CfgMgrBldr* Mgr<CfgMgrBldr>::instance = nullptr;
diff --git a/src/sdk/globals.cpp b/src/sdk/globals.cpp
index ad93f23..be12b59 100644
--- a/src/sdk/globals.cpp
+++ b/src/sdk/globals.cpp
@@ -41,7 +41,7 @@
 #include <string>
 
 #include "filefilters.h"
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 #include "filegroupsandmasks.h"
 
 #ifndef __WXMSW__
diff --git a/src/sdk/projectlayoutloader.cpp b/src/sdk/projectlayoutloader.cpp
index 68ed58d..c9d6c43 100644
--- a/src/sdk/projectlayoutloader.cpp
+++ b/src/sdk/projectlayoutloader.cpp
@@ -23,7 +23,7 @@
 
 #include "projectlayoutloader.h"
 #include "tinyxml/tinyxml.h"
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 
 ProjectLayoutLoader::ProjectLayoutLoader(cbProject* project)
     : m_pProject(project),
diff --git a/src/sdk/projectloader.cpp b/src/sdk/projectloader.cpp
index 8d42065..24aeae9 100644
--- a/src/sdk/projectloader.cpp
+++ b/src/sdk/projectloader.cpp
@@ -35,7 +35,7 @@
 #include "projectloader_hooks.h"
 #include "annoyingdialog.h"
 #include "configmanager.h"
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 #include "filegroupsandmasks.h"
 
 ProjectLoader::ProjectLoader(cbProject* project)
diff --git a/src/sdk/workspaceloader.cpp b/src/sdk/workspaceloader.cpp
index 45fd2d0..accbd05 100644
--- a/src/sdk/workspaceloader.cpp
+++ b/src/sdk/workspaceloader.cpp
@@ -28,7 +28,7 @@
 
 
 #include "tinyxml/tinyxml.h"
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 
 WorkspaceLoader::WorkspaceLoader()
 {
diff --git a/src/tools/cb_share_config/mainframe.cpp b/src/tools/cb_share_config/mainframe.cpp
index 1fd2024..e0b1f24 100644
--- a/src/tools/cb_share_config/mainframe.cpp
+++ b/src/tools/cb_share_config/mainframe.cpp
@@ -24,7 +24,7 @@
   #include <shlobj.h>
 #endif
 
-#include "tinyxml/tinywxuni.h"
+#include "tinywxuni.h"
 
 //***********************************************************************
 
-- 
1.9.0


From 284c37e58c5c1601a481bfbc0d2b13e7e9470184 Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Thu, 14 May 2009 09:42:37 +0200
Subject: [PATCH 03/38] move tinywxuni.cpp implementation from tinyxml into sdk

---
 src/base/tinyxml/Makefile.am   |  2 +-
 src/base/tinyxml/tinywxuni.cpp | 56 ------------------------------------------
 src/sdk/Makefile.am            |  1 +
 src/sdk/tinywxuni.cpp          | 56 ++++++++++++++++++++++++++++++++++++++++++
 4 files changed, 58 insertions(+), 57 deletions(-)
 delete mode 100644 src/base/tinyxml/tinywxuni.cpp
 create mode 100644 src/sdk/tinywxuni.cpp

diff --git a/src/base/tinyxml/Makefile.am b/src/base/tinyxml/Makefile.am
index 84fb465..a68530e 100644
--- a/src/base/tinyxml/Makefile.am
+++ b/src/base/tinyxml/Makefile.am
@@ -5,6 +5,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 
 noinst_LTLIBRARIES = libtinyxml.la
 
-libtinyxml_la_SOURCES = tinyxml.cpp tinyxmlerror.cpp tinyxmlparser.cpp tinywxuni.cpp
+libtinyxml_la_SOURCES = tinyxml.cpp tinyxmlerror.cpp tinyxmlparser.cpp
 
 EXTRA_DIST = tinystr.cpp
diff --git a/src/base/tinyxml/tinywxuni.cpp b/src/base/tinyxml/tinywxuni.cpp
deleted file mode 100644
index 57f48e3..0000000
--- a/src/base/tinyxml/tinywxuni.cpp
+++ /dev/null
@@ -1,56 +0,0 @@
-#include "sdk_precomp.h"
-
-#ifndef CB_PRECOMP
-    #include <wx/file.h>
-    #include <wx/string.h>
-    #include "filemanager.h"
-    #include "manager.h"
-#endif
-
-#include "tinywxuni.h"
-#include "tinyxml.h"
-
-bool TinyXML::LoadDocument(const wxString& filename, TiXmlDocument *doc)
-{
-
-    if (!doc || !wxFile::Access(filename, wxFile::read))
-        return false;
-
-    wxFile file(filename);
-    size_t len = file.Length();
-
-    if (!len)
-		return false;
-
-    char *input = new char[len+1];
-    input[len] = '\0';
-    file.Read(input, len);
-
-    doc->Parse(input);
-    delete[] input;
-    return true;
-}
-
-TiXmlDocument* TinyXML::LoadDocument(const wxString& filename)
-{
-    TiXmlDocument* doc = new TiXmlDocument();
-
-    if (TinyXML::LoadDocument(filename, doc))
-        return doc;
-
-    delete doc;
-    return 0;
-}
-
-bool TinyXML::SaveDocument(const wxString& filename, TiXmlDocument* doc)
-{
-    if (!doc)
-        return false;
-
-    TiXmlPrinter printer;
-    printer.SetIndent("\t");
-    doc->Accept(&printer);
-
-    return Manager::Get()->GetFileManager()->SaveUTF8(filename, printer.CStr(), printer.Size());
-}
-
diff --git a/src/sdk/Makefile.am b/src/sdk/Makefile.am
index 61b0389..998d3ef 100644
--- a/src/sdk/Makefile.am
+++ b/src/sdk/Makefile.am
@@ -111,6 +111,7 @@ libcodeblocks_la_SOURCES = annoyingdialog.cpp \
 						searchresultslog.cpp \
 						selecttargetdlg.cpp \
 						templatemanager.cpp \
+						tinywxuni.cpp \
 						toolsmanager.cpp \
 						uservarmanager.cpp \
 						virtualbuildtargetsdlg.cpp \
diff --git a/src/sdk/tinywxuni.cpp b/src/sdk/tinywxuni.cpp
new file mode 100644
index 0000000..57f48e3
--- /dev/null
+++ b/src/sdk/tinywxuni.cpp
@@ -0,0 +1,56 @@
+#include "sdk_precomp.h"
+
+#ifndef CB_PRECOMP
+    #include <wx/file.h>
+    #include <wx/string.h>
+    #include "filemanager.h"
+    #include "manager.h"
+#endif
+
+#include "tinywxuni.h"
+#include "tinyxml.h"
+
+bool TinyXML::LoadDocument(const wxString& filename, TiXmlDocument *doc)
+{
+
+    if (!doc || !wxFile::Access(filename, wxFile::read))
+        return false;
+
+    wxFile file(filename);
+    size_t len = file.Length();
+
+    if (!len)
+		return false;
+
+    char *input = new char[len+1];
+    input[len] = '\0';
+    file.Read(input, len);
+
+    doc->Parse(input);
+    delete[] input;
+    return true;
+}
+
+TiXmlDocument* TinyXML::LoadDocument(const wxString& filename)
+{
+    TiXmlDocument* doc = new TiXmlDocument();
+
+    if (TinyXML::LoadDocument(filename, doc))
+        return doc;
+
+    delete doc;
+    return 0;
+}
+
+bool TinyXML::SaveDocument(const wxString& filename, TiXmlDocument* doc)
+{
+    if (!doc)
+        return false;
+
+    TiXmlPrinter printer;
+    printer.SetIndent("\t");
+    doc->Accept(&printer);
+
+    return Manager::Get()->GetFileManager()->SaveUTF8(filename, printer.CStr(), printer.Size());
+}
+
-- 
1.9.0


From db71d1cdb1d515bdac4fbd890ae819eedef68da5 Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Thu, 14 May 2009 10:04:35 +0200
Subject: [PATCH 04/38] update C::B projects with new locations of tinywxuni

---
 src/CodeBlocks-unix.cbp | 4 ++--
 src/CodeBlocks.cbp      | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/CodeBlocks-unix.cbp b/src/CodeBlocks-unix.cbp
index 5080ce6..a1607d1 100644
--- a/src/CodeBlocks-unix.cbp
+++ b/src/CodeBlocks-unix.cbp
@@ -526,7 +526,7 @@
 		<Unit filename="base/tinyxml/tinystr.cpp">
 			<Option target="tinyXML" />
 		</Unit>
-		<Unit filename="base/tinyxml/tinywxuni.cpp">
+		<Unit filename="sdk/tinywxuni.cpp">
 			<Option target="sdk" />
 		</Unit>
 		<Unit filename="base/tinyxml/tinyxml.cpp">
@@ -1076,7 +1076,7 @@
 		<Unit filename="include/tinyxml/tinystr.h">
 			<Option target="tinyXML" />
 		</Unit>
-		<Unit filename="include/tinyxml/tinywxuni.h">
+		<Unit filename="include/tinywxuni.h">
 			<Option target="sdk" />
 		</Unit>
 		<Unit filename="include/tinyxml/tinyxml.h">
diff --git a/src/CodeBlocks.cbp b/src/CodeBlocks.cbp
index 0f973ab..adf972b 100644
--- a/src/CodeBlocks.cbp
+++ b/src/CodeBlocks.cbp
@@ -769,7 +769,7 @@
 		<Unit filename="base/tinyxml/tinystr.cpp">
 			<Option target="tinyXML" />
 		</Unit>
-		<Unit filename="base/tinyxml/tinywxuni.cpp">
+		<Unit filename="sdk/tinywxuni.cpp">
 			<Option target="sdk" />
 		</Unit>
 		<Unit filename="base/tinyxml/tinyxml.cpp">
@@ -1319,7 +1319,7 @@
 		<Unit filename="include/tinyxml/tinystr.h">
 			<Option target="tinyXML" />
 		</Unit>
-		<Unit filename="include/tinyxml/tinywxuni.h">
+		<Unit filename="include/tinywxuni.h">
 			<Option target="sdk" />
 		</Unit>
 		<Unit filename="include/tinyxml/tinyxml.h">
-- 
1.9.0


From ac56257a3ce1ccc08c5f022846aea47dc4bfe054 Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Thu, 14 May 2009 10:05:42 +0200
Subject: [PATCH 05/38] convert autorevision to new tinyxml handling

---
 src/build_tools/autorevision/Makefile.am      | 4 ++++
 src/build_tools/autorevision/autorevision.cpp | 3 +--
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/build_tools/autorevision/Makefile.am b/src/build_tools/autorevision/Makefile.am
index dfb38a9..125e7dc 100644
--- a/src/build_tools/autorevision/Makefile.am
+++ b/src/build_tools/autorevision/Makefile.am
@@ -3,7 +3,11 @@ auto_revision_SOURCES = autorevision.cpp
 
 AM_CPPFLAGS = -I$(top_srcdir)/src/include
 
+if ! HAVE_TINYXML
 auto_revision_LDADD = ../../base/tinyxml/libtinyxml.la
+else
+auto_revision_LDADD = -ltinyxml
+endif
 
 auto_revision_CXXFLAGS=-DTIXML_USE_STL
 
diff --git a/src/build_tools/autorevision/autorevision.cpp b/src/build_tools/autorevision/autorevision.cpp
index 008a3ca..e0a632a 100644
--- a/src/build_tools/autorevision/autorevision.cpp
+++ b/src/build_tools/autorevision/autorevision.cpp
@@ -11,8 +11,7 @@
 #include <string>
 #include <fstream>
 
-#include "tinyxml/tinystr.h"
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 
 using namespace std;
 
-- 
1.9.0


From 4e675dae5eb95f3a5f102364ae29921aab2eaeff Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Thu, 14 May 2009 17:33:02 +0200
Subject: [PATCH 06/38] convert sdk to new tinyxml handling

---
 src/include/configmanager.h         | 3 +--
 src/include/projecttemplateloader.h | 2 +-
 src/sdk/Makefile.am                 | 9 +++++++--
 src/sdk/globals.cpp                 | 2 +-
 src/sdk/pluginmanager.cpp           | 2 +-
 src/sdk/projectlayoutloader.cpp     | 2 +-
 src/sdk/tinywxuni.cpp               | 2 +-
 src/sdk/workspaceloader.cpp         | 2 +-
 8 files changed, 14 insertions(+), 10 deletions(-)

diff --git a/src/include/configmanager.h b/src/include/configmanager.h
index 890efc8..a70d4f8 100644
--- a/src/include/configmanager.h
+++ b/src/include/configmanager.h
@@ -12,8 +12,7 @@
 #include "settings.h"
 #include "globals.h"
 
-#include "tinyxml/tinystr.h"
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "manager.h"
 #include "base64.h"
 
diff --git a/src/include/projecttemplateloader.h b/src/include/projecttemplateloader.h
index 82b5c68..9add87c 100644
--- a/src/include/projecttemplateloader.h
+++ b/src/include/projecttemplateloader.h
@@ -6,7 +6,7 @@
 #ifndef PROJECTTEMPLATELOADER_H
 #define PROJECTTEMPLATELOADER_H
 
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "settings.h"
 
 struct FileSetFile
diff --git a/src/sdk/Makefile.am b/src/sdk/Makefile.am
index 998d3ef..6f81492 100644
--- a/src/sdk/Makefile.am
+++ b/src/sdk/Makefile.am
@@ -4,7 +4,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include \
 			-I$(top_srcdir)/src/sdk/wxscintilla/include \
 			 $(WXPROPGRID_INCLUDE) \
-			-I$(top_srcdir)/src/include/tinyxml \
 			-I$(top_srcdir)/src/include/scripting/include \
 			-I$(top_srcdir)/src/include/scripting/bindings \
  			-I$(top_srcdir)/src/include/scripting/sqplus \
@@ -23,11 +22,17 @@ libcodeblocks_la_LIBADD = scripting/bindings/libsqbindings.la \
 			scripting/sqplus/libsqplus.la \
 			scripting/sqstdlib/libsqstdlib.la \
 			scripting/squirrel/libsquirrel.la \
-			../base/tinyxml/libtinyxml.la \
 			wxscintilla/libwxscintilla.la \
 			$(WX_LIBS) \
 			$(WXPROPGRID_LIB)
 
+if ! HAVE_TINYXML
+INCLUDES +=		-I$(top_srcdir)/src/include/tinyxml
+libcodeblocks_la_LIBADD += ../base/tinyxml/libtinyxml.la
+else
+libcodeblocks_la_LIBADD += -ltinyxml
+endif
+
 libcodeblocks_la_SOURCES = annoyingdialog.cpp \
 						autodetectcompilers.cpp \
 						base64.cpp \
diff --git a/src/sdk/globals.cpp b/src/sdk/globals.cpp
index be12b59..196c77b 100644
--- a/src/sdk/globals.cpp
+++ b/src/sdk/globals.cpp
@@ -29,7 +29,7 @@
     #include "projectmanager.h"
 #endif
 
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 
 #include <wx/dirdlg.h>
 #include <wx/filefn.h>
diff --git a/src/sdk/pluginmanager.cpp b/src/sdk/pluginmanager.cpp
index ad96508..3089fcd 100644
--- a/src/sdk/pluginmanager.cpp
+++ b/src/sdk/pluginmanager.cpp
@@ -42,7 +42,7 @@
 #include <wx/txtstrm.h>
 
 #include "filefilters.h"
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 
 #include "annoyingdialog.h"
 #include "pluginsconfigurationdlg.h"
diff --git a/src/sdk/projectlayoutloader.cpp b/src/sdk/projectlayoutloader.cpp
index c9d6c43..b0f4025 100644
--- a/src/sdk/projectlayoutloader.cpp
+++ b/src/sdk/projectlayoutloader.cpp
@@ -22,7 +22,7 @@
 #endif
 
 #include "projectlayoutloader.h"
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "tinywxuni.h"
 
 ProjectLayoutLoader::ProjectLayoutLoader(cbProject* project)
diff --git a/src/sdk/tinywxuni.cpp b/src/sdk/tinywxuni.cpp
index 57f48e3..3b159e7 100644
--- a/src/sdk/tinywxuni.cpp
+++ b/src/sdk/tinywxuni.cpp
@@ -8,7 +8,7 @@
 #endif
 
 #include "tinywxuni.h"
-#include "tinyxml.h"
+#include <tinyxml.h>
 
 bool TinyXML::LoadDocument(const wxString& filename, TiXmlDocument *doc)
 {
diff --git a/src/sdk/workspaceloader.cpp b/src/sdk/workspaceloader.cpp
index accbd05..018a9bd 100644
--- a/src/sdk/workspaceloader.cpp
+++ b/src/sdk/workspaceloader.cpp
@@ -27,7 +27,7 @@
 
 
 
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "tinywxuni.h"
 
 WorkspaceLoader::WorkspaceLoader()
-- 
1.9.0


From f07c5057a3998fd71b411793ecd4fea6a10ffcc8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 12:36:33 +0200
Subject: [PATCH 07/38] update codecompletion plugin

---
 src/plugins/codecompletion/Makefile.am      | 4 ++++
 src/plugins/codecompletion/nativeparser.cpp | 1 +
 2 files changed, 5 insertions(+)

diff --git a/src/plugins/codecompletion/Makefile.am b/src/plugins/codecompletion/Makefile.am
index 933a4da..4a86cec 100644
--- a/src/plugins/codecompletion/Makefile.am
+++ b/src/plugins/codecompletion/Makefile.am
@@ -10,6 +10,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libcodecompletion.la
diff --git a/src/plugins/codecompletion/nativeparser.cpp b/src/plugins/codecompletion/nativeparser.cpp
index df7d2d7..7061e29 100644
--- a/src/plugins/codecompletion/nativeparser.cpp
+++ b/src/plugins/codecompletion/nativeparser.cpp
@@ -39,6 +39,7 @@
 #include <cbstyledtextctrl.h>
 #include <compilercommandgenerator.h>
 #include <projectloader_hooks.h>
+#include <tinyxml.h>
 
 #include "nativeparser.h"
 #include "classbrowser.h"
-- 
1.9.0


From 5df2617858efb8d7e089fc6f9b8e71dc42779a6c Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 12:38:01 +0200
Subject: [PATCH 08/38] update codesnippets plugin

---
 src/plugins/contrib/codesnippets/Makefile.am              | 4 ++++
 src/plugins/contrib/codesnippets/codesnippetstreectrl.cpp | 1 -
 src/plugins/contrib/codesnippets/codesnippetstreectrl.h   | 2 +-
 src/plugins/contrib/codesnippets/codesnippetswindow.cpp   | 2 +-
 4 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/src/plugins/contrib/codesnippets/Makefile.am b/src/plugins/contrib/codesnippets/Makefile.am
index ce74ba6..f4c9911 100644
--- a/src/plugins/contrib/codesnippets/Makefile.am
+++ b/src/plugins/contrib/codesnippets/Makefile.am
@@ -15,6 +15,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libcodesnippets.la
diff --git a/src/plugins/contrib/codesnippets/codesnippetstreectrl.cpp b/src/plugins/contrib/codesnippets/codesnippetstreectrl.cpp
index 65e6af5..ffbdc01 100644
--- a/src/plugins/contrib/codesnippets/codesnippetstreectrl.cpp
+++ b/src/plugins/contrib/codesnippets/codesnippetstreectrl.cpp
@@ -41,7 +41,6 @@
 //-#else
 //-#endif
 
-#include <tinyxml/tinyxml.h>
 #include "snippetitemdata.h"
 #include "codesnippetstreectrl.h"
 #include "codesnippetswindow.h"
diff --git a/src/plugins/contrib/codesnippets/codesnippetstreectrl.h b/src/plugins/contrib/codesnippets/codesnippetstreectrl.h
index e5778ae..8bcccd7 100644
--- a/src/plugins/contrib/codesnippets/codesnippetstreectrl.h
+++ b/src/plugins/contrib/codesnippets/codesnippetstreectrl.h
@@ -30,7 +30,7 @@ class TiXmlElement;
 #include "wx/mimetype.h"
 
 #include "snippetitemdata.h"
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include "snippetproperty.h"
 #include "codesnippetsevent.h"
 #include "snippetsconfig.h"
diff --git a/src/plugins/contrib/codesnippets/codesnippetswindow.cpp b/src/plugins/contrib/codesnippets/codesnippetswindow.cpp
index c0d1db7..64c7dcb 100644
--- a/src/plugins/contrib/codesnippets/codesnippetswindow.cpp
+++ b/src/plugins/contrib/codesnippets/codesnippetswindow.cpp
@@ -63,7 +63,7 @@
 #include "version.h"
 #include "codesnippetswindow.h"
 #include "snippetitemdata.h"
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include "snippetsconfig.h"
 #include "snippetsimages.h"
 #include "codesnippetstreectrl.h"
-- 
1.9.0


From 3314a1849eee9ef2729587d5d761067724779668 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 12:39:05 +0200
Subject: [PATCH 09/38] update envvars plugin

---
 src/plugins/contrib/envvars/Makefile.am | 4 ++++
 src/plugins/contrib/envvars/envvars.cpp | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/plugins/contrib/envvars/Makefile.am b/src/plugins/contrib/envvars/Makefile.am
index 4d3aa5e..3452cca 100644
--- a/src/plugins/contrib/envvars/Makefile.am
+++ b/src/plugins/contrib/envvars/Makefile.am
@@ -5,6 +5,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/scripting/bindings \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 pkgdata_DATA = envvars.zip
 
diff --git a/src/plugins/contrib/envvars/envvars.cpp b/src/plugins/contrib/envvars/envvars.cpp
index 1290b5a..bf72252 100644
--- a/src/plugins/contrib/envvars/envvars.cpp
+++ b/src/plugins/contrib/envvars/envvars.cpp
@@ -15,7 +15,7 @@
   #include <wx/menu.h>
   #include <wx/toolbar.h>
 
-  #include <tinyxml/tinyxml.h>
+  #include <tinyxml.h>
 
   #include "cbproject.h"
   #include "globals.h"
-- 
1.9.0


From 349493073cd1547e9eeb63cc1b19058a53d820e4 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 12:40:11 +0200
Subject: [PATCH 10/38] update BrowseTracker plugin

---
 src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp | 2 +-
 src/plugins/contrib/BrowseTracker/Makefile.am             | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp b/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp
index edeb044..44c3ae2 100644
--- a/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp
+++ b/src/plugins/contrib/BrowseTracker/BrowseTrackerLayout.cpp
@@ -46,7 +46,7 @@
 #endif
 
 #include <wx/tokenzr.h>
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "tinywxuni.h"
 
 #include "BrowseTrackerLayout.h"
diff --git a/src/plugins/contrib/BrowseTracker/Makefile.am b/src/plugins/contrib/BrowseTracker/Makefile.am
index ebd5650..7115870 100644
--- a/src/plugins/contrib/BrowseTracker/Makefile.am
+++ b/src/plugins/contrib/BrowseTracker/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libBrowseTracker.la
-- 
1.9.0


From 9822240b713fcf66a0d500f04912f9708a5ed8a0 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 12:41:03 +0200
Subject: [PATCH 11/38] update Valgrind plugin

---
 src/plugins/contrib/Valgrind/Makefile.am  | 4 ++++
 src/plugins/contrib/Valgrind/Valgrind.cpp | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/plugins/contrib/Valgrind/Makefile.am b/src/plugins/contrib/Valgrind/Makefile.am
index 755bd3e..826ad7d 100644
--- a/src/plugins/contrib/Valgrind/Makefile.am
+++ b/src/plugins/contrib/Valgrind/Makefile.am
@@ -4,6 +4,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libValgrind.la
diff --git a/src/plugins/contrib/Valgrind/Valgrind.cpp b/src/plugins/contrib/Valgrind/Valgrind.cpp
index cfd399e..cbcec86 100644
--- a/src/plugins/contrib/Valgrind/Valgrind.cpp
+++ b/src/plugins/contrib/Valgrind/Valgrind.cpp
@@ -25,7 +25,7 @@
 #include "macrosmanager.h"
 #endif
 #include <wx/filefn.h>
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "loggers.h"
 #include "Valgrind.h"
 #include "ValgrindListLog.h"
-- 
1.9.0


From dd82b3908ebd603e435c151d1db746154918cb43 Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Sat, 16 May 2009 12:04:35 +0200
Subject: [PATCH 12/38] convert AutoVersioning plugin

---
 src/plugins/contrib/AutoVersioning/AutoVersioning.cpp | 4 ++--
 src/plugins/contrib/AutoVersioning/Makefile.am        | 4 ++++
 src/plugins/contrib/AutoVersioning/avSvnRevision.cpp  | 2 +-
 3 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/src/plugins/contrib/AutoVersioning/AutoVersioning.cpp b/src/plugins/contrib/AutoVersioning/AutoVersioning.cpp
index f8603df..e049b07 100644
--- a/src/plugins/contrib/AutoVersioning/AutoVersioning.cpp
+++ b/src/plugins/contrib/AutoVersioning/AutoVersioning.cpp
@@ -17,9 +17,9 @@
 #include <manager.h>
 #include <projectbuildtarget.h>
 #include <projectmanager.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #endif
-#include <tinyxml/tinywxuni.h>
+#include <tinywxuni.h>
 #include <wx/textfile.h>
 
 #include "projectloader_hooks.h"
diff --git a/src/plugins/contrib/AutoVersioning/Makefile.am b/src/plugins/contrib/AutoVersioning/Makefile.am
index 54012bf..e60f5fc 100644
--- a/src/plugins/contrib/AutoVersioning/Makefile.am
+++ b/src/plugins/contrib/AutoVersioning/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libAutoVersioning.la
diff --git a/src/plugins/contrib/AutoVersioning/avSvnRevision.cpp b/src/plugins/contrib/AutoVersioning/avSvnRevision.cpp
index f99bd02..522a86f 100644
--- a/src/plugins/contrib/AutoVersioning/avSvnRevision.cpp
+++ b/src/plugins/contrib/AutoVersioning/avSvnRevision.cpp
@@ -3,7 +3,7 @@
 #include <wx/utils.h>
 #include <wx/string.h>
 #include <wx/arrstr.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include <globals.h>
 
 bool QuerySvn(const wxString& workingDir, wxString& revision, wxString& date)
-- 
1.9.0


From dd2be314d1bddd24a340416bf007c6c364082c6c Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Sat, 16 May 2009 12:10:45 +0200
Subject: [PATCH 13/38] convert lib_finder plugin

---
 src/plugins/contrib/lib_finder/Makefile.am                 | 4 ++++
 src/plugins/contrib/lib_finder/lib_finder.h                | 2 +-
 src/plugins/contrib/lib_finder/librarydetectionmanager.cpp | 2 +-
 src/plugins/contrib/lib_finder/projectconfiguration.h      | 2 +-
 4 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/src/plugins/contrib/lib_finder/Makefile.am b/src/plugins/contrib/lib_finder/Makefile.am
index 8c40ff0..c92550a 100644
--- a/src/plugins/contrib/lib_finder/Makefile.am
+++ b/src/plugins/contrib/lib_finder/Makefile.am
@@ -15,6 +15,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = liblib_finder.la
diff --git a/src/plugins/contrib/lib_finder/lib_finder.h b/src/plugins/contrib/lib_finder/lib_finder.h
index 0b03a40..9e0aa3a 100644
--- a/src/plugins/contrib/lib_finder/lib_finder.h
+++ b/src/plugins/contrib/lib_finder/lib_finder.h
@@ -27,7 +27,7 @@
 #include <cbplugin.h>
 #include <settings.h>
 #include <sdk_events.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #include "librarydetectionmanager.h"
 #include "resultmap.h"
diff --git a/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp b/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp
index a58776f..1c6985d 100644
--- a/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp
+++ b/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp
@@ -21,7 +21,7 @@
 * $HeadURL: http://svn.code.sf.net/p/codeblocks/code/branches/release-xx.yy/src/plugins/contrib/lib_finder/librarydetectionmanager.cpp $
 */
 
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include <tinywxuni.h>
 
 #include <wx/arrstr.h>
diff --git a/src/plugins/contrib/lib_finder/projectconfiguration.h b/src/plugins/contrib/lib_finder/projectconfiguration.h
index e7a337b..6416f09 100644
--- a/src/plugins/contrib/lib_finder/projectconfiguration.h
+++ b/src/plugins/contrib/lib_finder/projectconfiguration.h
@@ -27,7 +27,7 @@
 #include <wx/arrstr.h>
 #include <wx/string.h>
 #include <wx/hashmap.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include <cbproject.h>
 
 /** \brief Configuration of one project */
-- 
1.9.0


From e9704fc26bb864664b6a05c5185cc01de411553b Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Sat, 16 May 2009 12:20:55 +0200
Subject: [PATCH 14/38] convert wxSmith plugin

---
 src/plugins/contrib/wxSmith/Makefile.am                      | 4 ++++
 src/plugins/contrib/wxSmith/properties/Makefile.am           | 4 ++++
 src/plugins/contrib/wxSmith/properties/wxsproperty.h         | 2 +-
 src/plugins/contrib/wxSmith/wxsgui.h                         | 2 +-
 src/plugins/contrib/wxSmith/wxsmith.h                        | 2 +-
 src/plugins/contrib/wxSmith/wxsproject.h                     | 2 +-
 src/plugins/contrib/wxSmith/wxsversionconverter.h            | 2 +-
 src/plugins/contrib/wxSmith/wxwidgets/Makefile.am            | 4 ++++
 src/plugins/contrib/wxSmith/wxwidgets/wxsevents.h            | 2 +-
 src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdataobject.h | 2 +-
 10 files changed, 19 insertions(+), 7 deletions(-)

diff --git a/src/plugins/contrib/wxSmith/Makefile.am b/src/plugins/contrib/wxSmith/Makefile.am
index 97fcb68..866be15 100644
--- a/src/plugins/contrib/wxSmith/Makefile.am
+++ b/src/plugins/contrib/wxSmith/Makefile.am
@@ -15,6 +15,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 lib_LTLIBRARIES = libwxsmithlib.la
 
 libwxsmithlib_la_LDFLAGS = -version-info 0:1:0 -shared
diff --git a/src/plugins/contrib/wxSmith/properties/Makefile.am b/src/plugins/contrib/wxSmith/properties/Makefile.am
index aaa869d..356ace9 100644
--- a/src/plugins/contrib/wxSmith/properties/Makefile.am
+++ b/src/plugins/contrib/wxSmith/properties/Makefile.am
@@ -3,6 +3,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		$(WXPROPGRID_INCLUDE)
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 noinst_LTLIBRARIES = libwxsmith_properties.la
 
 libwxsmith_properties_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
diff --git a/src/plugins/contrib/wxSmith/properties/wxsproperty.h b/src/plugins/contrib/wxSmith/properties/wxsproperty.h
index 390924f..3cafe19 100644
--- a/src/plugins/contrib/wxSmith/properties/wxsproperty.h
+++ b/src/plugins/contrib/wxSmith/properties/wxsproperty.h
@@ -34,7 +34,7 @@
 #include <wx/propgrid/propgrid.h>
 #include <wx/propgrid/manager.h>
 
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include <prep.h>
 
 #include "wxspropertystream.h"
diff --git a/src/plugins/contrib/wxSmith/wxsgui.h b/src/plugins/contrib/wxSmith/wxsgui.h
index 7694750..48a06e3 100644
--- a/src/plugins/contrib/wxSmith/wxsgui.h
+++ b/src/plugins/contrib/wxSmith/wxsgui.h
@@ -24,7 +24,7 @@
 #define WXSGUI_H
 
 #include <configurationpanel.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include "wxsguifactory.h"
 #include "wxsproject.h"
 
diff --git a/src/plugins/contrib/wxSmith/wxsmith.h b/src/plugins/contrib/wxSmith/wxsmith.h
index bf7e712..00efe02 100644
--- a/src/plugins/contrib/wxSmith/wxsmith.h
+++ b/src/plugins/contrib/wxSmith/wxsmith.h
@@ -29,7 +29,7 @@
 #include <cbplugin.h>
 #include <settings.h>
 #include <sdk_events.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #include "wxsstoringsplitterwindow.h"
 #include "wxsresourcetree.h"
diff --git a/src/plugins/contrib/wxSmith/wxsproject.h b/src/plugins/contrib/wxSmith/wxsproject.h
index 7809091..dde9f20 100644
--- a/src/plugins/contrib/wxSmith/wxsproject.h
+++ b/src/plugins/contrib/wxSmith/wxsproject.h
@@ -24,7 +24,7 @@
 #define WXSPROJECT_H
 
 #include <cbproject.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include "wxsresourcetree.h"
 
 class wxSmith;
diff --git a/src/plugins/contrib/wxSmith/wxsversionconverter.h b/src/plugins/contrib/wxSmith/wxsversionconverter.h
index 3502492..b4b5eb2 100644
--- a/src/plugins/contrib/wxSmith/wxsversionconverter.h
+++ b/src/plugins/contrib/wxSmith/wxsversionconverter.h
@@ -23,7 +23,7 @@
 #ifndef WXSVERSIONCONVERTER_H
 #define WXSVERSIONCONVERTER_H
 
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include <wx/string.h>
 
 class wxsProject;
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
index 76d111b..313f2e4 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
@@ -9,6 +9,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
 		-I$(top_srcdir)/src/include/scripting/bindings
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 noinst_LTLIBRARIES = libwxsmith_wxwidgets.la
 
 libwxsmith_wxwidgets_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/wxsevents.h b/src/plugins/contrib/wxSmith/wxwidgets/wxsevents.h
index 3d0e599..80bffc0 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/wxsevents.h
+++ b/src/plugins/contrib/wxSmith/wxwidgets/wxsevents.h
@@ -24,7 +24,7 @@
 #define WXSEVENTS_H
 
 #include <wx/arrstr.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 #include <wx/arrstr.h>
 
 #include "wxscodercontext.h"
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdataobject.h b/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdataobject.h
index de6c60d..7a6dee2 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdataobject.h
+++ b/src/plugins/contrib/wxSmith/wxwidgets/wxsitemresdataobject.h
@@ -24,7 +24,7 @@
 #define WXSITEMRESDATAOBJECT_H
 
 #include <wx/dataobj.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #define wxsDF_WIDGET   _T("wxSmith XML")
 
-- 
1.9.0


From 0f14f90dc11bc3b8ff3d1d0041a81ffe39ea760a Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Sat, 16 May 2009 12:23:54 +0200
Subject: [PATCH 15/38] convert cb_share_config tool

---
 src/tools/cb_share_config/Makefile.am | 7 ++++++-
 src/tools/cb_share_config/mainframe.h | 3 +--
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/src/tools/cb_share_config/Makefile.am b/src/tools/cb_share_config/Makefile.am
index abba83d..689861a 100644
--- a/src/tools/cb_share_config/Makefile.am
+++ b/src/tools/cb_share_config/Makefile.am
@@ -2,12 +2,17 @@ bin_PROGRAMS = cb_share_config
 
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include \
-			-I$(top_srcdir)/src/include/tinyxml
 
 cb_share_config_LDFLAGS =
 
+if ! HAVE_TINYXML
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 cb_share_config_LDADD =  ../../base/tinyxml/libtinyxml.la \
 			$(WX_LIBS)
+else
+cb_share_config_LDADD = -ltinyxml $(WX_LIBS)
+endif
+
 
 cb_share_config_SOURCES = app.cpp \
 			mainframe.cpp
diff --git a/src/tools/cb_share_config/mainframe.h b/src/tools/cb_share_config/mainframe.h
index c49e790..b658bad 100644
--- a/src/tools/cb_share_config/mainframe.h
+++ b/src/tools/cb_share_config/mainframe.h
@@ -20,8 +20,7 @@
 #include <wx/arrstr.h>
 #include <vector>
 
-#include "tinyxml/tinystr.h"
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 
 class MainFrame: public wxFrame
 {
-- 
1.9.0


From 6dd5f2db98ef8782491cc6cdd8c487971d838a5a Mon Sep 17 00:00:00 2001
From: Dan Horak <dan@danny.cz>
Date: Sat, 16 May 2009 12:26:31 +0200
Subject: [PATCH 16/38] build local copy of tinyxml library only when no system
 tinyxml library exists

---
 src/base/Makefile.am | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/base/Makefile.am b/src/base/Makefile.am
index 34e0b85..eec0652 100644
--- a/src/base/Makefile.am
+++ b/src/base/Makefile.am
@@ -1,3 +1,5 @@
+if ! HAVE_TINYXML
 SUBDIRS = tinyxml
+endif
 
 EXTRA_DIST = exchndl
-- 
1.9.0


From 0b15212a5d1664f2574fc508c1db83cae76f79ed Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 13:07:12 +0200
Subject: [PATCH 17/38] fix include dirs for the main app when system tinyxml
 is not present

---
 src/plugins/autosave/Makefile.am                             | 4 ++++
 src/plugins/contrib/HexEditor/Makefile.am                    | 4 ++++
 src/plugins/contrib/ThreadSearch/Makefile.am                 | 4 ++++
 src/plugins/contrib/byogames/Makefile.am                     | 4 ++++
 src/plugins/contrib/codesnippets/resources/Makefile.am       | 4 ++++
 src/plugins/contrib/dragscroll/Makefile.am                   | 4 ++++
 src/plugins/contrib/headerfixup/Makefile.am                  | 4 ++++
 src/plugins/contrib/keybinder/Makefile.am                    | 4 ++++
 src/plugins/contrib/wxSmith/plugin/Makefile.am               | 4 ++++
 src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am   | 4 ++++
 src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am | 4 ++++
 src/plugins/contrib/wxSmithContribItems/Makefile.am          | 4 ++++
 src/plugins/openfileslist/Makefile.am                        | 4 ++++
 src/plugins/projectsimporter/Makefile.am                     | 3 +++
 src/plugins/scriptedwizard/Makefile.am                       | 4 ++++
 src/src/Makefile.am                                          | 4 ++++
 16 files changed, 63 insertions(+)

diff --git a/src/plugins/autosave/Makefile.am b/src/plugins/autosave/Makefile.am
index 48ef8ea..0c34bed 100644
--- a/src/plugins/autosave/Makefile.am
+++ b/src/plugins/autosave/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libautosave.la
diff --git a/src/plugins/contrib/HexEditor/Makefile.am b/src/plugins/contrib/HexEditor/Makefile.am
index 1fc237e..e0207df 100644
--- a/src/plugins/contrib/HexEditor/Makefile.am
+++ b/src/plugins/contrib/HexEditor/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libHexEditor.la
diff --git a/src/plugins/contrib/ThreadSearch/Makefile.am b/src/plugins/contrib/ThreadSearch/Makefile.am
index f4a9e1b..9bdd975 100644
--- a/src/plugins/contrib/ThreadSearch/Makefile.am
+++ b/src/plugins/contrib/ThreadSearch/Makefile.am
@@ -11,6 +11,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue \
 		-I$(srcdir)/../wxContribItems/wxthings/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libThreadSearch.la
diff --git a/src/plugins/contrib/byogames/Makefile.am b/src/plugins/contrib/byogames/Makefile.am
index 953d50a..d550aa9 100644
--- a/src/plugins/contrib/byogames/Makefile.am
+++ b/src/plugins/contrib/byogames/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libbyogames.la
diff --git a/src/plugins/contrib/codesnippets/resources/Makefile.am b/src/plugins/contrib/codesnippets/resources/Makefile.am
index b8c2402..94a0273 100644
--- a/src/plugins/contrib/codesnippets/resources/Makefile.am
+++ b/src/plugins/contrib/codesnippets/resources/Makefile.am
@@ -13,6 +13,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 ##pluginlib_LTLIBRARIES = codesnippets
diff --git a/src/plugins/contrib/dragscroll/Makefile.am b/src/plugins/contrib/dragscroll/Makefile.am
index 0773b14..766000a 100644
--- a/src/plugins/contrib/dragscroll/Makefile.am
+++ b/src/plugins/contrib/dragscroll/Makefile.am
@@ -3,6 +3,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/src \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libdragscroll.la
diff --git a/src/plugins/contrib/headerfixup/Makefile.am b/src/plugins/contrib/headerfixup/Makefile.am
index 54ba93c..94ded5f 100644
--- a/src/plugins/contrib/headerfixup/Makefile.am
+++ b/src/plugins/contrib/headerfixup/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
            -I$(top_srcdir)/src/include \
            -I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 CXXFLAGS = @CXXFLAGS@  -O0
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/keybinder/Makefile.am b/src/plugins/contrib/keybinder/Makefile.am
index f672f5b..3647ee9 100644
--- a/src/plugins/contrib/keybinder/Makefile.am
+++ b/src/plugins/contrib/keybinder/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libkeybinder.la
diff --git a/src/plugins/contrib/wxSmith/plugin/Makefile.am b/src/plugins/contrib/wxSmith/plugin/Makefile.am
index 79c5c83..869d4eb 100644
--- a/src/plugins/contrib/wxSmith/plugin/Makefile.am
+++ b/src/plugins/contrib/wxSmith/plugin/Makefile.am
@@ -3,6 +3,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		$(WXPROPGRID_INCLUDE)
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlib_LTLIBRARIES = libwxsmith.la
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am
index df7b1e3..3b68116 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am
@@ -3,6 +3,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		$(WXPROPGRID_INCLUDE)
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 noinst_LTLIBRARIES = libwxsmith_wxwidgets_defitems.la
 
 libwxsmith_wxwidgets_defitems_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am
index fd07ebb..56dfa9b 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am
@@ -3,6 +3,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		$(WXPROPGRID_INCLUDE)
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 noinst_LTLIBRARIES = libwxsmith_wxwidgets_properties.la
 
 libwxsmith_wxwidgets_properties_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
diff --git a/src/plugins/contrib/wxSmithContribItems/Makefile.am b/src/plugins/contrib/wxSmithContribItems/Makefile.am
index f0cca74..ea94ec3 100644
--- a/src/plugins/contrib/wxSmithContribItems/Makefile.am
+++ b/src/plugins/contrib/wxSmithContribItems/Makefile.am
@@ -19,6 +19,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(srcdir)/../wxContribItems/wxled/ledpanel/include
 
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libwxsmithcontribitems.la
diff --git a/src/plugins/openfileslist/Makefile.am b/src/plugins/openfileslist/Makefile.am
index 9f863e0..1ddb747 100644
--- a/src/plugins/openfileslist/Makefile.am
+++ b/src/plugins/openfileslist/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libopenfileslist.la
diff --git a/src/plugins/projectsimporter/Makefile.am b/src/plugins/projectsimporter/Makefile.am
index d22b42a..bb0205b 100644
--- a/src/plugins/projectsimporter/Makefile.am
+++ b/src/plugins/projectsimporter/Makefile.am
@@ -10,6 +10,9 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
 
 pluginlibdir = $(pkglibdir)/plugins
 
diff --git a/src/plugins/scriptedwizard/Makefile.am b/src/plugins/scriptedwizard/Makefile.am
index e14945c..a116b98 100644
--- a/src/plugins/scriptedwizard/Makefile.am
+++ b/src/plugins/scriptedwizard/Makefile.am
@@ -6,6 +6,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/sqplus
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libscriptedwizard.la
diff --git a/src/src/Makefile.am b/src/src/Makefile.am
index 76059eb..fa8c325 100644
--- a/src/src/Makefile.am
+++ b/src/src/Makefile.am
@@ -13,6 +13,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
  			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
  			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 if GTK_NOTEBOOK
 GTK_NOTEBOOK_FLAGS = -DUSE_GTK_NOTEBOOK
 endif
-- 
1.9.0


From 363e3bd34640d9668abe7fa781171f52fc976a67 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Tue, 18 Aug 2009 13:21:38 +0200
Subject: [PATCH 18/38] use/install local timyxml headers only when a
 system-wide instance doesn't exist

---
 src/include/Makefile.am | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/src/include/Makefile.am b/src/include/Makefile.am
index f7d7382..bfe01c6 100644
--- a/src/include/Makefile.am
+++ b/src/include/Makefile.am
@@ -1,4 +1,4 @@
-SUBDIRS = scripting tinyxml
+SUBDIRS = scripting
 
 if PRECOMPILE_HEADERS
 BUILT_SOURCES = $(top_builddir)/src/include/sdk.h.gch \
@@ -10,7 +10,6 @@ endif
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include \
 			-I$(top_srcdir)/src/sdk/wxscintilla/include \
-			-I$(top_srcdir)/src/include/tinyxml \
 			-I$(top_srcdir)/src/include/scripting/include \
  			-I$(top_srcdir)/src/include/scripting/sqplus \
 			-I$(top_srcdir)/src/include/mozilla_chardet \
@@ -20,6 +19,11 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+SUBDIRS += tinyxml
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 # Because we are not generating any programs/libraries with this makefile,
 # $(CXXCOMPILE) is empty.
 # Create the basic one here:
-- 
1.9.0


From b0f470009bdf4c7cfc523b8d719942cb47826848 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Tue, 18 Aug 2009 13:56:15 +0200
Subject: [PATCH 19/38] fix linking with tinyxml in the codesnippets plugin

---
 src/plugins/contrib/codesnippets/resources/Makefile.am | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/src/plugins/contrib/codesnippets/resources/Makefile.am b/src/plugins/contrib/codesnippets/resources/Makefile.am
index 94a0273..54cd35d 100644
--- a/src/plugins/contrib/codesnippets/resources/Makefile.am
+++ b/src/plugins/contrib/codesnippets/resources/Makefile.am
@@ -13,10 +13,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
-if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
-endif
-
 pluginlibdir = $(pkglibdir)/plugins
 
 ##pluginlib_LTLIBRARIES = codesnippets
@@ -25,9 +21,14 @@ bin_PROGRAMS = codesnippets
 ##codesnippets_LIBADD = $(WX_LIBS) ../../../../sdk/libcodeblocks.la
 ##codesnippets_LDADD = $(WX_LIBS) ../../../../sdk/libcodeblocks.la
 codesnippets_LDADD =  -L../../../../sdk ../../../../sdk/libcodeblocks.la \
-            ../../../../base/tinyxml/libtinyxml.la \
+	    -ltinyxml \
 			$(WX_LIBS) $(WX_GTK2_LIBS) $(WX_X11_LIBS)
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+codesnippets_LDADD += -L../../../../base/tinyxml
+endif
+
 codesnippets_SOURCES =	$(srcdir)/../version.cpp \
 		$(srcdir)/../Search/DirectoryParamsPanel.cpp \
 		$(srcdir)/../Search/InsertIndexManager.cpp \
-- 
1.9.0


From 1a1e66b5f1157dc26d62cf74b0ade7037ef98278 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Mon, 15 Feb 2010 21:34:45 +0100
Subject: [PATCH 20/38] fix tinyxml includes in the help plugin

---
 src/plugins/contrib/help_plugin/Makefile.am | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/plugins/contrib/help_plugin/Makefile.am b/src/plugins/contrib/help_plugin/Makefile.am
index d71d32e..181a54d 100644
--- a/src/plugins/contrib/help_plugin/Makefile.am
+++ b/src/plugins/contrib/help_plugin/Makefile.am
@@ -37,6 +37,10 @@ else
 libhelp_plugin_la_LIBADD += -lz
 endif
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 libhelp_plugin_la_SOURCES = help_common.cpp \
 			HelpConfigDialog.cpp \
 			help_plugin.cpp \
-- 
1.9.0


From 3cc3efc434a50842971df76ecec5f6f465044a16 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Mon, 15 Feb 2010 21:37:48 +0100
Subject: [PATCH 21/38] fix tinyxml includes in the wxSmithAui plugin

---
 src/plugins/contrib/wxSmithAui/Makefile.am | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/plugins/contrib/wxSmithAui/Makefile.am b/src/plugins/contrib/wxSmithAui/Makefile.am
index 097bae1..367d04f 100644
--- a/src/plugins/contrib/wxSmithAui/Makefile.am
+++ b/src/plugins/contrib/wxSmithAui/Makefile.am
@@ -7,6 +7,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(srcdir)/wxAuiNotebook \
 		-I$(srcdir)/wxAuiToolBar
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libwxSmithAui.la
-- 
1.9.0


From 0669d1f74b6a4c87aa7c3fede59bcf00e676fa46 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Mon, 15 Feb 2010 21:39:14 +0100
Subject: [PATCH 22/38] fix tinyxml includes in the MouseSap plugin

---
 src/plugins/contrib/MouseSap/Makefile.am | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/plugins/contrib/MouseSap/Makefile.am b/src/plugins/contrib/MouseSap/Makefile.am
index c13907e..3c887ae 100644
--- a/src/plugins/contrib/MouseSap/Makefile.am
+++ b/src/plugins/contrib/MouseSap/Makefile.am
@@ -3,6 +3,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libMouseSap.la
-- 
1.9.0


From 9442d6b29133adeddb81c3d4cbc12d83ffb46716 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Tue, 24 Aug 2010 08:55:17 +0200
Subject: [PATCH 23/38] fix tinyxml includes in the DoxyBlocks plugin

---
 src/plugins/contrib/DoxyBlocks/DoxyBlocks.cpp | 2 +-
 src/plugins/contrib/DoxyBlocks/Makefile.am    | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/plugins/contrib/DoxyBlocks/DoxyBlocks.cpp b/src/plugins/contrib/DoxyBlocks/DoxyBlocks.cpp
index a7d1273..403996b 100644
--- a/src/plugins/contrib/DoxyBlocks/DoxyBlocks.cpp
+++ b/src/plugins/contrib/DoxyBlocks/DoxyBlocks.cpp
@@ -40,7 +40,7 @@
 #include <cbstyledtextctrl.h>
 #include <configurationpanel.h>
 #include <projectloader_hooks.h>
-#include <tinyxml/tinywxuni.h>
+#include <tinywxuni.h>
 
 #include <wx/tokenzr.h>
 #include <wx/textfile.h>
diff --git a/src/plugins/contrib/DoxyBlocks/Makefile.am b/src/plugins/contrib/DoxyBlocks/Makefile.am
index 76a9ad5..eab64ae 100644
--- a/src/plugins/contrib/DoxyBlocks/Makefile.am
+++ b/src/plugins/contrib/DoxyBlocks/Makefile.am
@@ -4,6 +4,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libDoxyBlocks.la
-- 
1.9.0


From 4528304c4bf667380da6c65376994acfcdafce42 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Tue, 24 Aug 2010 09:55:32 +0200
Subject: [PATCH 24/38] fix tinyxml includes in the NassiShneiderman plugin

---
 src/plugins/contrib/NassiShneiderman/Makefile.am | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/plugins/contrib/NassiShneiderman/Makefile.am b/src/plugins/contrib/NassiShneiderman/Makefile.am
index c6342a2..7ad0175 100644
--- a/src/plugins/contrib/NassiShneiderman/Makefile.am
+++ b/src/plugins/contrib/NassiShneiderman/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libNassiShneiderman.la
-- 
1.9.0


From bc35b99c3501833628e79947a94470d2f50f4ac2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sun, 23 Jan 2011 09:38:55 +0100
Subject: [PATCH 25/38] fix tinyxml includes in the ReopenEditor plugin

---
 src/plugins/contrib/ReopenEditor/Makefile.am | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/plugins/contrib/ReopenEditor/Makefile.am b/src/plugins/contrib/ReopenEditor/Makefile.am
index 2b8a355..6d66e53 100644
--- a/src/plugins/contrib/ReopenEditor/Makefile.am
+++ b/src/plugins/contrib/ReopenEditor/Makefile.am
@@ -2,6 +2,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libReopenEditor.la
-- 
1.9.0


From bf2d93be8f2924e2fecab5cf6b65c4dd6e9a86c3 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:50:27 +0100
Subject: [PATCH 26/38] fix tinyxml includes in the DoxyBlock plugin

---
 src/plugins/contrib/DoxyBlocks/ConfigPanel.cpp | 2 +-
 src/plugins/contrib/DoxyBlocks/DoxyBlocks.h    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/plugins/contrib/DoxyBlocks/ConfigPanel.cpp b/src/plugins/contrib/DoxyBlocks/ConfigPanel.cpp
index 3a62a02..79499a5 100644
--- a/src/plugins/contrib/DoxyBlocks/ConfigPanel.cpp
+++ b/src/plugins/contrib/DoxyBlocks/ConfigPanel.cpp
@@ -33,7 +33,7 @@
 #include <configmanager.h>
 #include <editorcolourset.h>
 #include <editormanager.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #include "version.h"
 
diff --git a/src/plugins/contrib/DoxyBlocks/DoxyBlocks.h b/src/plugins/contrib/DoxyBlocks/DoxyBlocks.h
index daa0b5b..dfc7541 100644
--- a/src/plugins/contrib/DoxyBlocks/DoxyBlocks.h
+++ b/src/plugins/contrib/DoxyBlocks/DoxyBlocks.h
@@ -25,7 +25,7 @@
 
 #include <cbplugin.h>
 #include <cbstyledtextctrl.h>
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #include "Config.h"
 
-- 
1.9.0


From ea910892ca6c4217dbd6f8f980e775a8d17c755d Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:51:39 +0100
Subject: [PATCH 27/38] fix tinyxml includes in the CppCheck plugin

---
 src/plugins/contrib/CppCheck/CppCheck.cpp | 2 +-
 src/plugins/contrib/CppCheck/Makefile.am  | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/plugins/contrib/CppCheck/CppCheck.cpp b/src/plugins/contrib/CppCheck/CppCheck.cpp
index 19445fa..953d395 100644
--- a/src/plugins/contrib/CppCheck/CppCheck.cpp
+++ b/src/plugins/contrib/CppCheck/CppCheck.cpp
@@ -32,7 +32,7 @@
 #include <wx/filefn.h>
 #include <wx/utils.h>
 
-#include "tinyxml/tinyxml.h"
+#include <tinyxml.h>
 #include "filefilters.h"
 #include "loggers.h"
 
diff --git a/src/plugins/contrib/CppCheck/Makefile.am b/src/plugins/contrib/CppCheck/Makefile.am
index 0e3550f..b46e2b7 100644
--- a/src/plugins/contrib/CppCheck/Makefile.am
+++ b/src/plugins/contrib/CppCheck/Makefile.am
@@ -4,6 +4,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libCppCheck.la
-- 
1.9.0


From f5d6819403cf6569f0e90fc3e599608c9391a90a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 16 May 2009 13:07:12 +0200
Subject: [PATCH 28/38] fix include dirs for the main app when system tinyxml
 is not present

---
 src/plugins/contrib/codesnippets/resources/Makefile.am | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/plugins/contrib/codesnippets/resources/Makefile.am b/src/plugins/contrib/codesnippets/resources/Makefile.am
index 54cd35d..5735fec 100644
--- a/src/plugins/contrib/codesnippets/resources/Makefile.am
+++ b/src/plugins/contrib/codesnippets/resources/Makefile.am
@@ -13,6 +13,10 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/base \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
+if ! HAVE_TINYXML
+INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 ##pluginlib_LTLIBRARIES = codesnippets
-- 
1.9.0


From 7d2fc3e09ed64e3107fe87ec81b9afcb8b9a82aa Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sun, 2 Sep 2012 15:34:58 +0200
Subject: [PATCH 29/38] fix tinyxml includes in projectimporter plugin

---
 src/plugins/projectsimporter/msvc10loader.cpp | 2 +-
 src/plugins/projectsimporter/msvc7loader.cpp  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/plugins/projectsimporter/msvc10loader.cpp b/src/plugins/projectsimporter/msvc10loader.cpp
index e6c6856..f071c43 100644
--- a/src/plugins/projectsimporter/msvc10loader.cpp
+++ b/src/plugins/projectsimporter/msvc10loader.cpp
@@ -23,7 +23,7 @@
 
 #include <wx/choicdlg.h>
 
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #include "prep.h"
 #include "msvc10loader.h"
diff --git a/src/plugins/projectsimporter/msvc7loader.cpp b/src/plugins/projectsimporter/msvc7loader.cpp
index 7d1aae8..3eee8d0 100644
--- a/src/plugins/projectsimporter/msvc7loader.cpp
+++ b/src/plugins/projectsimporter/msvc7loader.cpp
@@ -23,7 +23,7 @@
 
 #include <wx/choicdlg.h>
 
-#include <tinyxml/tinyxml.h>
+#include <tinyxml.h>
 
 #include "prep.h"
 #include "msvc7loader.h"
-- 
1.9.0


From 5a443cb50da8947d98c395c2cac661c533da1d09 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 17:35:30 +0100
Subject: [PATCH 30/38] add check for squirrel to configure.in

---
 configure.ac | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/configure.ac b/configure.ac
index 9997857..2617746 100644
--- a/configure.ac
+++ b/configure.ac
@@ -71,11 +71,19 @@ AC_CHECK_HEADER(tinyxml.h, [HAVE_TINYXML=yes], [HAVE_TINYXML=no])
 CC=$save_CC
 CPP=$save_CPP
 
-
 AM_CONDITIONAL([HAVE_ZLIB], [test "$HAVE_ZLIB" = yes])
 AM_CONDITIONAL([HAVE_BZIP2], [test "$HAVE_BZIP2" = yes])
 AM_CONDITIONAL([HAVE_TINYXML], [test "$HAVE_TINYXML" = yes])
 
+AC_CHECK_PROG(HAVE_PKG_CONFIG, pkg-config, yes, no)
+PKG_PROG_PKG_CONFIG
+PKG_CHECK_MODULES([SQUIRREL], [squirrel], [HAVE_SQUIRREL=yes], [HAVE_SQUIRREL=no])
+AM_CONDITIONAL([HAVE_SQUIRREL], [test "$HAVE_SQUIRREL" = yes])
+CB_SQUIRREL_CFLAGS="$SQUIRREL_CFLAGS"
+CB_SQUIRREL_LIBS="$SQUIRREL_LIBS"
+AC_SUBST(CB_SQUIRREL_CFLAGS)
+AC_SUBST(CB_SQUIRREL_LIBS)
+
 dnl versioning info for libtool
 dnl Note this is the ABI version which is not the same as our actual library version
 CODEBLOCKS_CURRENT=0
-- 
1.9.0


From 983fd2cba4a37f1bed5a958f4ef6ec45b95f6023 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:28:16 +0100
Subject: [PATCH 31/38] disable unicode for squirrel

---
 src/include/scripting/sqplus/sqplus.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/include/scripting/sqplus/sqplus.h b/src/include/scripting/sqplus/sqplus.h
index a44ad3e..123bc20 100644
--- a/src/include/scripting/sqplus/sqplus.h
+++ b/src/include/scripting/sqplus/sqplus.h
@@ -47,6 +47,7 @@
 #define SQ_CALL_RAISE_ERROR SQFalse
 #endif
 
+#undef _UNICODE
 #include "squirrel.h"
 
 // C::B patch: so it builds on 64bit, ecapsulate bool/int/float using Squirrel types (this patch applies everywhere, where threse types are used)
-- 
1.9.0


From 307e24a88573fa32a26bb884beae517fda7c35e8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:33:13 +0100
Subject: [PATCH 32/38] convert includes to system squirrel

---
 src/include/Makefile.am           | 7 ++++++-
 src/include/scripting/Makefile.am | 5 ++++-
 2 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/src/include/Makefile.am b/src/include/Makefile.am
index bfe01c6..e49497c 100644
--- a/src/include/Makefile.am
+++ b/src/include/Makefile.am
@@ -10,7 +10,6 @@ endif
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include \
 			-I$(top_srcdir)/src/sdk/wxscintilla/include \
-			-I$(top_srcdir)/src/include/scripting/include \
  			-I$(top_srcdir)/src/include/scripting/sqplus \
 			-I$(top_srcdir)/src/include/mozilla_chardet \
 			-I$(top_srcdir)/src/include/mozilla_chardet/mfbt \
@@ -24,6 +23,12 @@ SUBDIRS += tinyxml
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 # Because we are not generating any programs/libraries with this makefile,
 # $(CXXCOMPILE) is empty.
 # Create the basic one here:
diff --git a/src/include/scripting/Makefile.am b/src/include/scripting/Makefile.am
index 39ea807..36adf08 100644
--- a/src/include/scripting/Makefile.am
+++ b/src/include/scripting/Makefile.am
@@ -1 +1,4 @@
-SUBDIRS = squirrel sqstdlib sqplus bindings include
+SUBDIRS = sqplus bindings
+if ! HAVE_SQUIRREL
+SUBDIRS += squirrel sqstdlib include
+endif
-- 
1.9.0


From 4bd4ae4d6e83bab17c2b563bc050ff0932f8534f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:34:17 +0100
Subject: [PATCH 33/38] convert sdk to system squirrel

---
 src/sdk/Makefile.am                    | 11 ++++++++---
 src/sdk/scripting/Makefile.am          |  6 +++++-
 src/sdk/scripting/bindings/Makefile.am |  8 +++++++-
 src/sdk/scripting/sqplus/Makefile.am   |  9 +++++++--
 4 files changed, 27 insertions(+), 7 deletions(-)

diff --git a/src/sdk/Makefile.am b/src/sdk/Makefile.am
index 6f81492..ff75090 100644
--- a/src/sdk/Makefile.am
+++ b/src/sdk/Makefile.am
@@ -4,7 +4,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include \
 			-I$(top_srcdir)/src/sdk/wxscintilla/include \
 			 $(WXPROPGRID_INCLUDE) \
-			-I$(top_srcdir)/src/include/scripting/include \
 			-I$(top_srcdir)/src/include/scripting/bindings \
  			-I$(top_srcdir)/src/include/scripting/sqplus \
  			-I$(top_srcdir)/src/include/mozilla_chardet \
@@ -20,8 +19,6 @@ libcodeblocks_la_LDFLAGS = -version-info @CODEBLOCKS_VERSION_INFO@
 
 libcodeblocks_la_LIBADD = scripting/bindings/libsqbindings.la \
 			scripting/sqplus/libsqplus.la \
-			scripting/sqstdlib/libsqstdlib.la \
-			scripting/squirrel/libsquirrel.la \
 			wxscintilla/libwxscintilla.la \
 			$(WX_LIBS) \
 			$(WXPROPGRID_LIB)
@@ -33,6 +30,14 @@ else
 libcodeblocks_la_LIBADD += -ltinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+libcodeblocks_la_LIBADD += $(SQUIRREL_LIBS)
+else
+INCLUDES += 		-I$(top_srcdir)/src/include/scripting/include
+libcodeblocks_la_LIBADD += scripting/squirrel/libsquirrel.la scripting/sqstdlib/libsqstdlib.la
+endif
+
 libcodeblocks_la_SOURCES = annoyingdialog.cpp \
 						autodetectcompilers.cpp \
 						base64.cpp \
diff --git a/src/sdk/scripting/Makefile.am b/src/sdk/scripting/Makefile.am
index f2bff06..f1a5d1c 100644
--- a/src/sdk/scripting/Makefile.am
+++ b/src/sdk/scripting/Makefile.am
@@ -1 +1,5 @@
-SUBDIRS = squirrel sqstdlib sqplus bindings
+SUBDIRS = sqplus bindings
+if ! HAVE_SQUIRREL
+SUBDIRS += squirrel sqstdlib
+endif
+
diff --git a/src/sdk/scripting/bindings/Makefile.am b/src/sdk/scripting/bindings/Makefile.am
index 51a05c9..21bef47 100644
--- a/src/sdk/scripting/bindings/Makefile.am
+++ b/src/sdk/scripting/bindings/Makefile.am
@@ -1,10 +1,16 @@
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include \
 			-I$(top_srcdir)/src/sdk/wxscintilla/include \
-			-I$(top_srcdir)/src/include/scripting/include \
 			-I$(top_srcdir)/src/include/scripting/bindings \
 			-I$(top_srcdir)/src/include/scripting/sqplus
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
+
 noinst_LTLIBRARIES = libsqbindings.la
 
 libsqbindings_la_SOURCES = scriptbindings.cpp \
diff --git a/src/sdk/scripting/sqplus/Makefile.am b/src/sdk/scripting/sqplus/Makefile.am
index 2cdd579..4c0cf53 100644
--- a/src/sdk/scripting/sqplus/Makefile.am
+++ b/src/sdk/scripting/sqplus/Makefile.am
@@ -1,5 +1,10 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src/include/scripting/include \
-					-I$(top_srcdir)/src/include/scripting/sqplus
+if HAVE_SQUIRREL
+AM_CPPFLAGS = $(SQUIRREL_CFLAGS)
+else
+AM_CPPFLAGS = -I$(top_srcdir)/src/include/scripting/include
+endif
+
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/sqplus
 
 noinst_LTLIBRARIES = libsqplus.la
 
-- 
1.9.0


From c15abfc2b00692ca003e0431729a7ad02117c32b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:34:53 +0100
Subject: [PATCH 34/38] convert main to system squirrel

---
 src/src/Makefile.am | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/src/Makefile.am b/src/src/Makefile.am
index fa8c325..4176634 100644
--- a/src/src/Makefile.am
+++ b/src/src/Makefile.am
@@ -4,7 +4,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/sdk/wxscintilla/include \
 			$(WXPROPGRID_INCLUDE) \
 			-I$(top_srcdir)/src/include \
-			-I$(top_srcdir)/src/include/scripting/include \
 			-I$(top_srcdir)/src/include/scripting/sqplus \
  			-I$(top_srcdir)/src/include/mozilla_chardet \
  			-I$(top_srcdir)/src/include/mozilla_chardet/mfbt \
@@ -17,6 +16,13 @@ if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
+
 if GTK_NOTEBOOK
 GTK_NOTEBOOK_FLAGS = -DUSE_GTK_NOTEBOOK
 endif
-- 
1.9.0


From c6464ac4e9500e9082305a3cb36c1561f4888cd4 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 14 Jan 2012 23:35:32 +0100
Subject: [PATCH 35/38] convert plugins to system squirrel

---
 src/plugins/abbreviations/Makefile.am             |  6 +++++-
 src/plugins/compilergcc/Makefile.am               |  7 ++++++-
 src/plugins/contrib/envvars/Makefile.am           |  7 ++++++-
 src/plugins/contrib/help_plugin/Makefile.am       | 10 +++++++++-
 src/plugins/contrib/lib_finder/Makefile.am        |  8 ++++++--
 src/plugins/contrib/wxSmith/Makefile.am           |  8 ++++++--
 src/plugins/contrib/wxSmith/wxwidgets/Makefile.am |  8 ++++++--
 src/plugins/debuggergdb/Makefile.am               |  7 ++++++-
 src/plugins/scriptedwizard/Makefile.am            |  7 ++++++-
 9 files changed, 56 insertions(+), 12 deletions(-)

diff --git a/src/plugins/abbreviations/Makefile.am b/src/plugins/abbreviations/Makefile.am
index 09d408e..e6bd0fc 100644
--- a/src/plugins/abbreviations/Makefile.am
+++ b/src/plugins/abbreviations/Makefile.am
@@ -3,10 +3,14 @@ SUBDIRS = resources
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
-		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
 		-I$(top_srcdir)/src/include/scripting/bindings
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
 
 pluginlibdir = $(pkglibdir)/plugins
 
diff --git a/src/plugins/compilergcc/Makefile.am b/src/plugins/compilergcc/Makefile.am
index e5b7318..99a6318 100644
--- a/src/plugins/compilergcc/Makefile.am
+++ b/src/plugins/compilergcc/Makefile.am
@@ -3,10 +3,15 @@ SUBDIRS = depslib resources
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
-		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
 		-I$(top_srcdir)/src/plugins/compilergcc/depslib/src
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 AM_CXXFLAGS = -DDEPSLIB_UNIX
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/envvars/Makefile.am b/src/plugins/contrib/envvars/Makefile.am
index 3452cca..4298b7f 100644
--- a/src/plugins/contrib/envvars/Makefile.am
+++ b/src/plugins/contrib/envvars/Makefile.am
@@ -1,6 +1,5 @@
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
-		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
 		-I$(top_srcdir)/src/include/scripting/bindings \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
@@ -9,6 +8,12 @@ if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 pkgdata_DATA = envvars.zip
 
diff --git a/src/plugins/contrib/help_plugin/Makefile.am b/src/plugins/contrib/help_plugin/Makefile.am
index 181a54d..ce77e72 100644
--- a/src/plugins/contrib/help_plugin/Makefile.am
+++ b/src/plugins/contrib/help_plugin/Makefile.am
@@ -10,7 +10,6 @@ endif
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
-		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/bindings \
 		-I$(top_srcdir)/src/include/scripting/sqplus
 
@@ -41,6 +40,15 @@ if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+libhelp_plugin_la_LIBADD += $(SQUIRREL_LIBS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+libhelp_plugin_la_LIBADD += 	../../../sdk/scripting/sqstdlib/libsqstdlib.la \
+				../../../sdk/scripting/squirrel/libsquirrel.la
+endif
+
 libhelp_plugin_la_SOURCES = help_common.cpp \
 			HelpConfigDialog.cpp \
 			help_plugin.cpp \
diff --git a/src/plugins/contrib/lib_finder/Makefile.am b/src/plugins/contrib/lib_finder/Makefile.am
index c92550a..e68a735 100644
--- a/src/plugins/contrib/lib_finder/Makefile.am
+++ b/src/plugins/contrib/lib_finder/Makefile.am
@@ -4,9 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		-I$(srcdir)/../wxContribItems/wxFlatNotebook/include \
-		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
-		-I$(top_srcdir)/src/include/scripting/squirrel \
 		-I$(top_srcdir)/src/include/scripting/bindings \
 		-I$(top_srcdir)/src/include/mozilla_chardet \
 		-I$(top_srcdir)/src/include/mozilla_chardet/mfbt \
@@ -19,6 +17,12 @@ if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = liblib_finder.la
diff --git a/src/plugins/contrib/wxSmith/Makefile.am b/src/plugins/contrib/wxSmith/Makefile.am
index 866be15..f06659c 100644
--- a/src/plugins/contrib/wxSmith/Makefile.am
+++ b/src/plugins/contrib/wxSmith/Makefile.am
@@ -4,8 +4,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		$(WXPROPGRID_INCLUDE) \
-		-I$(top_srcdir)/src/include/scripting/include \
-		-I$(top_srcdir)/src/include/scripting/squirrel \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
 		-I$(top_srcdir)/src/include/scripting/bindings \
 		-I$(top_srcdir)/src/include/mozilla_chardet \
@@ -19,6 +17,12 @@ if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 lib_LTLIBRARIES = libwxsmithlib.la
 
 libwxsmithlib_la_LDFLAGS = -version-info 0:1:0 -shared
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
index 313f2e4..f7e524d 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
@@ -4,8 +4,6 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
 		$(WXPROPGRID_INCLUDE) \
-		-I$(top_srcdir)/src/include/scripting/include \
-		-I$(top_srcdir)/src/include/scripting/squirrel \
 		-I$(top_srcdir)/src/include/scripting/sqplus \
 		-I$(top_srcdir)/src/include/scripting/bindings
 
@@ -13,6 +11,12 @@ if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 noinst_LTLIBRARIES = libwxsmith_wxwidgets.la
 
 libwxsmith_wxwidgets_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
diff --git a/src/plugins/debuggergdb/Makefile.am b/src/plugins/debuggergdb/Makefile.am
index e17c114..b482325 100644
--- a/src/plugins/debuggergdb/Makefile.am
+++ b/src/plugins/debuggergdb/Makefile.am
@@ -3,9 +3,14 @@ SUBDIRS = resources
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
-		-I$(top_srcdir)/src/include/scripting/include \
     	-I$(top_srcdir)/src/include/scripting/sqplus
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libdebugger.la
diff --git a/src/plugins/scriptedwizard/Makefile.am b/src/plugins/scriptedwizard/Makefile.am
index a116b98..352d5b9 100644
--- a/src/plugins/scriptedwizard/Makefile.am
+++ b/src/plugins/scriptedwizard/Makefile.am
@@ -3,13 +3,18 @@ SUBDIRS = resources
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include \
-		-I$(top_srcdir)/src/include/scripting/include \
 		-I$(top_srcdir)/src/include/scripting/sqplus
 
 if ! HAVE_TINYXML
 INCLUDES += -I$(top_srcdir)/src/include/tinyxml
 endif
 
+if HAVE_SQUIRREL
+INCLUDES += $(SQUIRREL_CFLAGS)
+else
+INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
 pluginlib_LTLIBRARIES = libscriptedwizard.la
-- 
1.9.0


From a1f05b124f8b6773e5e78b3f00c51ff1867fbc1b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sat, 7 Dec 2013 12:51:52 +0100
Subject: [PATCH 36/38] switch to AM_CPPFLAGS from INCLUDES

---
 src/include/Makefile.am                                      | 6 +++---
 src/plugins/abbreviations/Makefile.am                        | 4 ++--
 src/plugins/autosave/Makefile.am                             | 2 +-
 src/plugins/codecompletion/Makefile.am                       | 2 +-
 src/plugins/compilergcc/Makefile.am                          | 4 ++--
 src/plugins/contrib/AutoVersioning/Makefile.am               | 2 +-
 src/plugins/contrib/BrowseTracker/Makefile.am                | 2 +-
 src/plugins/contrib/CppCheck/Makefile.am                     | 2 +-
 src/plugins/contrib/DoxyBlocks/Makefile.am                   | 2 +-
 src/plugins/contrib/HexEditor/Makefile.am                    | 2 +-
 src/plugins/contrib/MouseSap/Makefile.am                     | 2 +-
 src/plugins/contrib/NassiShneiderman/Makefile.am             | 2 +-
 src/plugins/contrib/ReopenEditor/Makefile.am                 | 2 +-
 src/plugins/contrib/ThreadSearch/Makefile.am                 | 2 +-
 src/plugins/contrib/Valgrind/Makefile.am                     | 2 +-
 src/plugins/contrib/byogames/Makefile.am                     | 2 +-
 src/plugins/contrib/codesnippets/Makefile.am                 | 2 +-
 src/plugins/contrib/codesnippets/resources/Makefile.am       | 4 ++--
 src/plugins/contrib/dragscroll/Makefile.am                   | 2 +-
 src/plugins/contrib/envvars/Makefile.am                      | 6 +++---
 src/plugins/contrib/headerfixup/Makefile.am                  | 2 +-
 src/plugins/contrib/help_plugin/Makefile.am                  | 6 +++---
 src/plugins/contrib/keybinder/Makefile.am                    | 2 +-
 src/plugins/contrib/lib_finder/Makefile.am                   | 6 +++---
 src/plugins/contrib/wxSmith/Makefile.am                      | 6 +++---
 src/plugins/contrib/wxSmith/plugin/Makefile.am               | 2 +-
 src/plugins/contrib/wxSmith/properties/Makefile.am           | 2 +-
 src/plugins/contrib/wxSmith/wxwidgets/Makefile.am            | 6 +++---
 src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am   | 2 +-
 src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am | 2 +-
 src/plugins/contrib/wxSmithAui/Makefile.am                   | 2 +-
 src/plugins/contrib/wxSmithContribItems/Makefile.am          | 2 +-
 src/plugins/debuggergdb/Makefile.am                          | 4 ++--
 src/plugins/openfileslist/Makefile.am                        | 2 +-
 src/plugins/projectsimporter/Makefile.am                     | 2 +-
 src/plugins/scriptedwizard/Makefile.am                       | 6 +++---
 src/sdk/Makefile.am                                          | 6 +++---
 src/sdk/scripting/bindings/Makefile.am                       | 4 ++--
 src/src/Makefile.am                                          | 6 +++---
 src/tools/cb_share_config/Makefile.am                        | 2 +-
 40 files changed, 63 insertions(+), 63 deletions(-)

diff --git a/src/include/Makefile.am b/src/include/Makefile.am
index e49497c..61dc555 100644
--- a/src/include/Makefile.am
+++ b/src/include/Makefile.am
@@ -20,13 +20,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 
 if ! HAVE_TINYXML
 SUBDIRS += tinyxml
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 # Because we are not generating any programs/libraries with this makefile,
diff --git a/src/plugins/abbreviations/Makefile.am b/src/plugins/abbreviations/Makefile.am
index e6bd0fc..4e08744 100644
--- a/src/plugins/abbreviations/Makefile.am
+++ b/src/plugins/abbreviations/Makefile.am
@@ -7,9 +7,9 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/scripting/bindings
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/autosave/Makefile.am b/src/plugins/autosave/Makefile.am
index 0c34bed..f239600 100644
--- a/src/plugins/autosave/Makefile.am
+++ b/src/plugins/autosave/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/codecompletion/Makefile.am b/src/plugins/codecompletion/Makefile.am
index 4a86cec..34fe3c0 100644
--- a/src/plugins/codecompletion/Makefile.am
+++ b/src/plugins/codecompletion/Makefile.am
@@ -11,7 +11,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/compilergcc/Makefile.am b/src/plugins/compilergcc/Makefile.am
index 99a6318..fdeb668 100644
--- a/src/plugins/compilergcc/Makefile.am
+++ b/src/plugins/compilergcc/Makefile.am
@@ -7,9 +7,9 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/plugins/compilergcc/depslib/src
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 AM_CXXFLAGS = -DDEPSLIB_UNIX
diff --git a/src/plugins/contrib/AutoVersioning/Makefile.am b/src/plugins/contrib/AutoVersioning/Makefile.am
index e60f5fc..a2c7834 100644
--- a/src/plugins/contrib/AutoVersioning/Makefile.am
+++ b/src/plugins/contrib/AutoVersioning/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/BrowseTracker/Makefile.am b/src/plugins/contrib/BrowseTracker/Makefile.am
index 7115870..27a42fb 100644
--- a/src/plugins/contrib/BrowseTracker/Makefile.am
+++ b/src/plugins/contrib/BrowseTracker/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/CppCheck/Makefile.am b/src/plugins/contrib/CppCheck/Makefile.am
index b46e2b7..ab81d19 100644
--- a/src/plugins/contrib/CppCheck/Makefile.am
+++ b/src/plugins/contrib/CppCheck/Makefile.am
@@ -5,7 +5,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/DoxyBlocks/Makefile.am b/src/plugins/contrib/DoxyBlocks/Makefile.am
index eab64ae..250c28c 100644
--- a/src/plugins/contrib/DoxyBlocks/Makefile.am
+++ b/src/plugins/contrib/DoxyBlocks/Makefile.am
@@ -5,7 +5,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/HexEditor/Makefile.am b/src/plugins/contrib/HexEditor/Makefile.am
index e0207df..68d1e06 100644
--- a/src/plugins/contrib/HexEditor/Makefile.am
+++ b/src/plugins/contrib/HexEditor/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/MouseSap/Makefile.am b/src/plugins/contrib/MouseSap/Makefile.am
index 3c887ae..c4a19e7 100644
--- a/src/plugins/contrib/MouseSap/Makefile.am
+++ b/src/plugins/contrib/MouseSap/Makefile.am
@@ -4,7 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/NassiShneiderman/Makefile.am b/src/plugins/contrib/NassiShneiderman/Makefile.am
index 7ad0175..807e40f 100644
--- a/src/plugins/contrib/NassiShneiderman/Makefile.am
+++ b/src/plugins/contrib/NassiShneiderman/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/ReopenEditor/Makefile.am b/src/plugins/contrib/ReopenEditor/Makefile.am
index 6d66e53..ef43ef2 100644
--- a/src/plugins/contrib/ReopenEditor/Makefile.am
+++ b/src/plugins/contrib/ReopenEditor/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/ThreadSearch/Makefile.am b/src/plugins/contrib/ThreadSearch/Makefile.am
index 9bdd975..0e1c694 100644
--- a/src/plugins/contrib/ThreadSearch/Makefile.am
+++ b/src/plugins/contrib/ThreadSearch/Makefile.am
@@ -12,7 +12,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(srcdir)/../wxContribItems/wxthings/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/Valgrind/Makefile.am b/src/plugins/contrib/Valgrind/Makefile.am
index 826ad7d..ad36cc2 100644
--- a/src/plugins/contrib/Valgrind/Makefile.am
+++ b/src/plugins/contrib/Valgrind/Makefile.am
@@ -5,7 +5,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/byogames/Makefile.am b/src/plugins/contrib/byogames/Makefile.am
index d550aa9..fa21af4 100644
--- a/src/plugins/contrib/byogames/Makefile.am
+++ b/src/plugins/contrib/byogames/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/codesnippets/Makefile.am b/src/plugins/contrib/codesnippets/Makefile.am
index f4c9911..2d12f0c 100644
--- a/src/plugins/contrib/codesnippets/Makefile.am
+++ b/src/plugins/contrib/codesnippets/Makefile.am
@@ -16,7 +16,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/codesnippets/resources/Makefile.am b/src/plugins/contrib/codesnippets/resources/Makefile.am
index 5735fec..0811383 100644
--- a/src/plugins/contrib/codesnippets/resources/Makefile.am
+++ b/src/plugins/contrib/codesnippets/resources/Makefile.am
@@ -14,7 +14,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
@@ -29,7 +29,7 @@ codesnippets_LDADD =  -L../../../../sdk ../../../../sdk/libcodeblocks.la \
 			$(WX_LIBS) $(WX_GTK2_LIBS) $(WX_X11_LIBS)
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 codesnippets_LDADD += -L../../../../base/tinyxml
 endif
 
diff --git a/src/plugins/contrib/dragscroll/Makefile.am b/src/plugins/contrib/dragscroll/Makefile.am
index 766000a..49b986b 100644
--- a/src/plugins/contrib/dragscroll/Makefile.am
+++ b/src/plugins/contrib/dragscroll/Makefile.am
@@ -4,7 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/envvars/Makefile.am b/src/plugins/contrib/envvars/Makefile.am
index 4298b7f..a2a6663 100644
--- a/src/plugins/contrib/envvars/Makefile.am
+++ b/src/plugins/contrib/envvars/Makefile.am
@@ -5,13 +5,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/headerfixup/Makefile.am b/src/plugins/contrib/headerfixup/Makefile.am
index 94ded5f..ac96bb0 100644
--- a/src/plugins/contrib/headerfixup/Makefile.am
+++ b/src/plugins/contrib/headerfixup/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
            -I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 CXXFLAGS = @CXXFLAGS@  -O0
diff --git a/src/plugins/contrib/help_plugin/Makefile.am b/src/plugins/contrib/help_plugin/Makefile.am
index ce77e72..daa73b1 100644
--- a/src/plugins/contrib/help_plugin/Makefile.am
+++ b/src/plugins/contrib/help_plugin/Makefile.am
@@ -37,14 +37,14 @@ libhelp_plugin_la_LIBADD += -lz
 endif
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 libhelp_plugin_la_LIBADD += $(SQUIRREL_LIBS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 libhelp_plugin_la_LIBADD += 	../../../sdk/scripting/sqstdlib/libsqstdlib.la \
 				../../../sdk/scripting/squirrel/libsquirrel.la
 endif
diff --git a/src/plugins/contrib/keybinder/Makefile.am b/src/plugins/contrib/keybinder/Makefile.am
index 3647ee9..d2cfcb9 100644
--- a/src/plugins/contrib/keybinder/Makefile.am
+++ b/src/plugins/contrib/keybinder/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/lib_finder/Makefile.am b/src/plugins/contrib/lib_finder/Makefile.am
index e68a735..884ebcf 100644
--- a/src/plugins/contrib/lib_finder/Makefile.am
+++ b/src/plugins/contrib/lib_finder/Makefile.am
@@ -14,13 +14,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/wxSmith/Makefile.am b/src/plugins/contrib/wxSmith/Makefile.am
index f06659c..642ac78 100644
--- a/src/plugins/contrib/wxSmith/Makefile.am
+++ b/src/plugins/contrib/wxSmith/Makefile.am
@@ -14,13 +14,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 lib_LTLIBRARIES = libwxsmithlib.la
diff --git a/src/plugins/contrib/wxSmith/plugin/Makefile.am b/src/plugins/contrib/wxSmith/plugin/Makefile.am
index 869d4eb..a350758 100644
--- a/src/plugins/contrib/wxSmith/plugin/Makefile.am
+++ b/src/plugins/contrib/wxSmith/plugin/Makefile.am
@@ -4,7 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		$(WXPROPGRID_INCLUDE)
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlib_LTLIBRARIES = libwxsmith.la
diff --git a/src/plugins/contrib/wxSmith/properties/Makefile.am b/src/plugins/contrib/wxSmith/properties/Makefile.am
index 356ace9..2ab4923 100644
--- a/src/plugins/contrib/wxSmith/properties/Makefile.am
+++ b/src/plugins/contrib/wxSmith/properties/Makefile.am
@@ -4,7 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		$(WXPROPGRID_INCLUDE)
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 noinst_LTLIBRARIES = libwxsmith_properties.la
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
index f7e524d..2b48671 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/Makefile.am
@@ -8,13 +8,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/scripting/bindings
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 noinst_LTLIBRARIES = libwxsmith_wxwidgets.la
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am
index 3b68116..76442e2 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/defitems/Makefile.am
@@ -4,7 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		$(WXPROPGRID_INCLUDE)
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 noinst_LTLIBRARIES = libwxsmith_wxwidgets_defitems.la
diff --git a/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am b/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am
index 56dfa9b..9e09652 100644
--- a/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am
+++ b/src/plugins/contrib/wxSmith/wxwidgets/properties/Makefile.am
@@ -4,7 +4,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		$(WXPROPGRID_INCLUDE)
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 noinst_LTLIBRARIES = libwxsmith_wxwidgets_properties.la
diff --git a/src/plugins/contrib/wxSmithAui/Makefile.am b/src/plugins/contrib/wxSmithAui/Makefile.am
index 367d04f..1453f26 100644
--- a/src/plugins/contrib/wxSmithAui/Makefile.am
+++ b/src/plugins/contrib/wxSmithAui/Makefile.am
@@ -8,7 +8,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(srcdir)/wxAuiToolBar
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/contrib/wxSmithContribItems/Makefile.am b/src/plugins/contrib/wxSmithContribItems/Makefile.am
index ea94ec3..031944e 100644
--- a/src/plugins/contrib/wxSmithContribItems/Makefile.am
+++ b/src/plugins/contrib/wxSmithContribItems/Makefile.am
@@ -20,7 +20,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/debuggergdb/Makefile.am b/src/plugins/debuggergdb/Makefile.am
index b482325..6c648e9 100644
--- a/src/plugins/debuggergdb/Makefile.am
+++ b/src/plugins/debuggergdb/Makefile.am
@@ -6,9 +6,9 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
     	-I$(top_srcdir)/src/include/scripting/sqplus
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/openfileslist/Makefile.am b/src/plugins/openfileslist/Makefile.am
index 1ddb747..9f546d2 100644
--- a/src/plugins/openfileslist/Makefile.am
+++ b/src/plugins/openfileslist/Makefile.am
@@ -3,7 +3,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/sdk/wxscintilla/include
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/projectsimporter/Makefile.am b/src/plugins/projectsimporter/Makefile.am
index bb0205b..ca63562 100644
--- a/src/plugins/projectsimporter/Makefile.am
+++ b/src/plugins/projectsimporter/Makefile.am
@@ -11,7 +11,7 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/plugins/scriptedwizard/Makefile.am b/src/plugins/scriptedwizard/Makefile.am
index 352d5b9..6969eea 100644
--- a/src/plugins/scriptedwizard/Makefile.am
+++ b/src/plugins/scriptedwizard/Makefile.am
@@ -6,13 +6,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 		-I$(top_srcdir)/src/include/scripting/sqplus
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 pluginlibdir = $(pkglibdir)/plugins
diff --git a/src/sdk/Makefile.am b/src/sdk/Makefile.am
index ff75090..b1cfa7e 100644
--- a/src/sdk/Makefile.am
+++ b/src/sdk/Makefile.am
@@ -24,17 +24,17 @@ libcodeblocks_la_LIBADD = scripting/bindings/libsqbindings.la \
 			$(WXPROPGRID_LIB)
 
 if ! HAVE_TINYXML
-INCLUDES +=		-I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS +=		-I$(top_srcdir)/src/include/tinyxml
 libcodeblocks_la_LIBADD += ../base/tinyxml/libtinyxml.la
 else
 libcodeblocks_la_LIBADD += -ltinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 libcodeblocks_la_LIBADD += $(SQUIRREL_LIBS)
 else
-INCLUDES += 		-I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += 		-I$(top_srcdir)/src/include/scripting/include
 libcodeblocks_la_LIBADD += scripting/squirrel/libsquirrel.la scripting/sqstdlib/libsqstdlib.la
 endif
 
diff --git a/src/sdk/scripting/bindings/Makefile.am b/src/sdk/scripting/bindings/Makefile.am
index 21bef47..c684c53 100644
--- a/src/sdk/scripting/bindings/Makefile.am
+++ b/src/sdk/scripting/bindings/Makefile.am
@@ -5,9 +5,9 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
 			-I$(top_srcdir)/src/include/scripting/sqplus
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 
diff --git a/src/src/Makefile.am b/src/src/Makefile.am
index 4176634..1279ab4 100644
--- a/src/src/Makefile.am
+++ b/src/src/Makefile.am
@@ -13,13 +13,13 @@ AM_CPPFLAGS = $(WX_CXXFLAGS) \
  			-I$(top_srcdir)/src/include/mozilla_chardet/xpcom/glue
 
 if ! HAVE_TINYXML
-INCLUDES += -I$(top_srcdir)/src/include/tinyxml
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/tinyxml
 endif
 
 if HAVE_SQUIRREL
-INCLUDES += $(SQUIRREL_CFLAGS)
+AM_CPPFLAGS += $(SQUIRREL_CFLAGS)
 else
-INCLUDES += -I$(top_srcdir)/src/include/scripting/include
+AM_CPPFLAGS += -I$(top_srcdir)/src/include/scripting/include
 endif
 
 
diff --git a/src/tools/cb_share_config/Makefile.am b/src/tools/cb_share_config/Makefile.am
index 689861a..9f94d47 100644
--- a/src/tools/cb_share_config/Makefile.am
+++ b/src/tools/cb_share_config/Makefile.am
@@ -1,7 +1,7 @@
 bin_PROGRAMS = cb_share_config
 
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
-			-I$(top_srcdir)/src/include \
+			-I$(top_srcdir)/src/include
 
 cb_share_config_LDFLAGS =
 
-- 
1.9.0


From 742a53b389a51c48cb46eb3ce4ebd47b21300811 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sun, 16 Mar 2014 22:38:12 +0100
Subject: [PATCH 37/38] unbundle astyle library

- use system provided astyle library
- rename the plugin so it doesn't clash with the library name we need to link with
---
 configure.ac                                |  2 ++
 src/plugins/astyle/Makefile.am              | 21 ++++++++++++++-------
 src/plugins/astyle/asstreamiterator.h       |  2 +-
 src/plugins/astyle/dlgformattersettings.cpp |  2 +-
 src/plugins/astyle/dlgformattersettings.h   |  2 +-
 src/plugins/astyle/formattersettings.cpp    |  2 +-
 src/plugins/astyle/formattersettings.h      |  2 +-
 src/plugins/astyle/resources/Makefile.am    |  6 +++---
 8 files changed, 24 insertions(+), 15 deletions(-)

diff --git a/configure.ac b/configure.ac
index 2617746..9c123a1 100644
--- a/configure.ac
+++ b/configure.ac
@@ -68,12 +68,14 @@ save_CPP=$CPP
 CC=$CXX
 CPP=$CXXCPP
 AC_CHECK_HEADER(tinyxml.h, [HAVE_TINYXML=yes], [HAVE_TINYXML=no])
+AC_CHECK_HEADER(astyle.h, [HAVE_ASTYLE=yes], [HAVE_ASTYLE=no])
 CC=$save_CC
 CPP=$save_CPP
 
 AM_CONDITIONAL([HAVE_ZLIB], [test "$HAVE_ZLIB" = yes])
 AM_CONDITIONAL([HAVE_BZIP2], [test "$HAVE_BZIP2" = yes])
 AM_CONDITIONAL([HAVE_TINYXML], [test "$HAVE_TINYXML" = yes])
+AM_CONDITIONAL([HAVE_ASTYLE], [test "$HAVE_ASTYLE" = yes])
 
 AC_CHECK_PROG(HAVE_PKG_CONFIG, pkg-config, yes, no)
 PKG_PROG_PKG_CONFIG
diff --git a/src/plugins/astyle/Makefile.am b/src/plugins/astyle/Makefile.am
index a84e3a9..0b5c231 100644
--- a/src/plugins/astyle/Makefile.am
+++ b/src/plugins/astyle/Makefile.am
@@ -1,27 +1,34 @@
 SUBDIRS = resources
 
 AM_CPPFLAGS = $(WX_CXXFLAGS) \
-           -I$(top_srcdir)/src/plugins/astyle/astyle \
            -I$(top_srcdir)/src/include \
            -I$(top_srcdir)/src/sdk/wxscintilla/include
 
+if ! HAVE_ASTYLE
+AM_CPPFLAGS += -I$(top_srcdir)/src/plugins/astyle/astyle
+endif
+
 pluginlibdir = $(pkglibdir)/plugins
 
-pluginlib_LTLIBRARIES = libastyle.la
+pluginlib_LTLIBRARIES = libAstyle.la
 
-libastyle_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
+libAstyle_la_LDFLAGS = -module -version-info 0:1:0 -shared -no-undefined -avoid-version
 
-libastyle_la_LIBADD = ../../sdk/libcodeblocks.la $(WX_LIBS)
+libAstyle_la_LIBADD = ../../sdk/libcodeblocks.la $(WX_LIBS)
 
-libastyle_la_SOURCES = asstreamiterator.cpp \
+libAstyle_la_SOURCES = asstreamiterator.cpp \
                        astyleconfigdlg.cpp \
                        astyleplugin.cpp \
                        dlgformattersettings.cpp \
-                       formattersettings.cpp \
-                       astyle/ASBeautifier.cpp \
+                       formattersettings.cpp
+if ! HAVE_ASTYLE
+libAstyle_la_SOURCES += astyle/ASBeautifier.cpp \
                        astyle/ASEnhancer.cpp \
                        astyle/ASFormatter.cpp \
                        astyle/ASResource.cpp
+else
+libAstyle_la_LIBADD += -lastyle
+endif
 
 noinst_HEADERS = asstreamiterator.h \
                  astyleconfigdlg.h \
diff --git a/src/plugins/astyle/asstreamiterator.h b/src/plugins/astyle/asstreamiterator.h
index d30398d..7679c7f 100644
--- a/src/plugins/astyle/asstreamiterator.h
+++ b/src/plugins/astyle/asstreamiterator.h
@@ -10,7 +10,7 @@
 #include <wx/string.h>
 #include <cbeditor.h>
 #include <vector>
-#include "astyle/astyle.h"
+#include <astyle.h>
 
 class ASStreamIterator : public astyle::ASSourceIterator
 {
diff --git a/src/plugins/astyle/astyleplugin.cpp b/src/plugins/astyle/astyleplugin.cpp
index b3f3320..86aeac6 100644
--- a/src/plugins/astyle/astyleplugin.cpp
+++ b/src/plugins/astyle/astyleplugin.cpp
@@ -56,8 +56,8 @@ AStylePlugin::AStylePlugin()
 {
     //ctor
 
-    if (!Manager::LoadResource(_T("astyle.zip")))
-        NotifyMissingFile(_T("astyle.zip"));
+    if (!Manager::LoadResource(_T("Astyle.zip")))
+        NotifyMissingFile(_T("Astyle.zip"));
 }
 
 AStylePlugin::~AStylePlugin()
diff --git a/src/plugins/astyle/dlgformattersettings.cpp b/src/plugins/astyle/dlgformattersettings.cpp
index 30dca00..4e31963 100644
--- a/src/plugins/astyle/dlgformattersettings.cpp
+++ b/src/plugins/astyle/dlgformattersettings.cpp
@@ -69,7 +69,7 @@ void DlgFormatterSettings::ApplyTo(astyle::ASFormatter& formatter)
     formatter.setBlockIndent(XRCCTRL(*m_dlg, "chkIndentBlocks",                  wxCheckBox)->GetValue());
     formatter.setNamespaceIndent(XRCCTRL(*m_dlg, "chkIndentNamespaces",          wxCheckBox)->GetValue());
     formatter.setLabelIndent(XRCCTRL(*m_dlg, "chkIndentLabels",                  wxCheckBox)->GetValue());
-    formatter.setPreprocessorIndent(XRCCTRL(*m_dlg, "chkIndentPreprocessor",     wxCheckBox)->GetValue());
+    formatter.setPreprocDefineIndent(XRCCTRL(*m_dlg, "chkIndentPreprocessor",     wxCheckBox)->GetValue());
     formatter.setIndentCol1CommentsMode(XRCCTRL(*m_dlg, "chkIndentCol1Comments", wxCheckBox)->GetValue());
 
     wxString pointerAlign = XRCCTRL(*m_dlg, "cmbPointerAlign", wxComboBox)->GetValue();
diff --git a/src/plugins/astyle/dlgformattersettings.h b/src/plugins/astyle/dlgformattersettings.h
index 61d0520..ad2a313 100644
--- a/src/plugins/astyle/dlgformattersettings.h
+++ b/src/plugins/astyle/dlgformattersettings.h
@@ -10,7 +10,7 @@
 #ifndef DLGFORMATTERSETTINGS_H
 #define DLGFORMATTERSETTINGS_H
 
-#include "astyle/astyle.h"
+#include <astyle.h>
 
 class wxWindow;
 
diff --git a/src/plugins/astyle/formattersettings.cpp b/src/plugins/astyle/formattersettings.cpp
index ff8b1bc..3ee5d09 100644
--- a/src/plugins/astyle/formattersettings.cpp
+++ b/src/plugins/astyle/formattersettings.cpp
@@ -98,7 +98,7 @@ void FormatterSettings::ApplyTo(astyle::ASFormatter& formatter)
   formatter.setBlockIndent(cfg->ReadBool(_T("/indent_blocks")));
   formatter.setNamespaceIndent(cfg->ReadBool(_T("/indent_namespaces")));
   formatter.setLabelIndent(cfg->ReadBool(_T("/indent_labels")));
-  formatter.setPreprocessorIndent(cfg->ReadBool(_T("/indent_preprocessor")));
+  formatter.setPreprocDefineIndent(cfg->ReadBool(_T("/indent_preprocessor")));
   formatter.setIndentCol1CommentsMode(cfg->ReadBool(_T("/indent_col1_comments")));
 
   wxString pointerAlign = cfg->Read(_T("/pointer_align"));
diff --git a/src/plugins/astyle/formattersettings.h b/src/plugins/astyle/formattersettings.h
index 0f88a3c..431d0fa 100644
--- a/src/plugins/astyle/formattersettings.h
+++ b/src/plugins/astyle/formattersettings.h
@@ -6,7 +6,7 @@
 #ifndef FORMATTERSETTINGS_H
 #define FORMATTERSETTINGS_H
 
-#include "astyle/astyle.h"
+#include <astyle.h>
 
 class FormatterSettings
 {
diff --git a/src/plugins/astyle/resources/Makefile.am b/src/plugins/astyle/resources/Makefile.am
index f7ca9bb..89c337a 100644
--- a/src/plugins/astyle/resources/Makefile.am
+++ b/src/plugins/astyle/resources/Makefile.am
@@ -1,7 +1,7 @@
 EXTRA_DIST = configuration.xrc manifest.xml
 
-pkgdata_DATA = astyle.zip
+pkgdata_DATA = Astyle.zip
 CLEANFILES = $(pkgdata_DATA)
 
-astyle.zip: $(EXTRA_DIST)
-	PWD=`pwd` cd $(srcdir) && zip $(PWD)/astyle.zip manifest.xml *.xrc > /dev/null
+Astyle.zip: $(EXTRA_DIST)
+	PWD=`pwd` cd $(srcdir) && zip $(PWD)/Astyle.zip manifest.xml *.xrc > /dev/null
-- 
1.9.0


From bbffcdad51f6c6dbd39bcc47f95775f2ee8e2782 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan@danny.cz>
Date: Sun, 27 Apr 2014 11:53:14 +0200
Subject: [PATCH 38/38] move bundled astyle to the new API

---
 src/plugins/astyle/astyle/ASBeautifier.cpp | 4 ++--
 src/plugins/astyle/astyle/astyle.h         | 2 +-
 src/plugins/astyle/astyle/astyle_main.cpp  | 2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/plugins/astyle/astyle/ASBeautifier.cpp b/src/plugins/astyle/astyle/ASBeautifier.cpp
index 513835c..77476f3 100644
--- a/src/plugins/astyle/astyle/ASBeautifier.cpp
+++ b/src/plugins/astyle/astyle/ASBeautifier.cpp
@@ -69,7 +69,7 @@ ASBeautifier::ASBeautifier()
 	setLabelIndent(false);
 	setEmptyLineFill(false);
 	setCStyle();
-	setPreprocessorIndent(false);
+	setPreprocDefineIndent(false);
 	setAlignMethodColon(false);
 
 	// initialize ASBeautifier member vectors
@@ -604,7 +604,7 @@ void ASBeautifier::setLabelIndent(bool state)
  *
  * @param   state             state of option.
  */
-void ASBeautifier::setPreprocessorIndent(bool state)
+void ASBeautifier::setPreprocDefineIndent(bool state)
 {
 	preprocessorIndent = state;
 }
diff --git a/src/plugins/astyle/astyle/astyle.h b/src/plugins/astyle/astyle/astyle.h
index 4a85acd..75f2d59 100644
--- a/src/plugins/astyle/astyle/astyle.h
+++ b/src/plugins/astyle/astyle/astyle.h
@@ -368,7 +368,7 @@ class ASBeautifier : protected ASResource, protected ASBase
 		void setSpaceIndentation(int length = 4);
 		void setSwitchIndent(bool state);
 		void setTabIndentation(int length = 4, bool forceTabs = false);
-		void setPreprocessorIndent(bool state);
+		void setPreprocDefineIndent(bool state);
 		int  getBeautifierFileType() const;
 		int  getFileType() const;
 		int  getIndentLength(void) const;
diff --git a/src/plugins/astyle/astyle/astyle_main.cpp b/src/plugins/astyle/astyle/astyle_main.cpp
index 8de6e2a..66fbf53 100644
--- a/src/plugins/astyle/astyle/astyle_main.cpp
+++ b/src/plugins/astyle/astyle/astyle_main.cpp
@@ -3046,7 +3046,7 @@ void ASOptions::parseOption(const string &arg, const string &errorInfo)
 	}
 	else if ( isOption(arg, "w", "indent-preprocessor") )
 	{
-		formatter.setPreprocessorIndent(true);
+		formatter.setPreprocDefineIndent(true);
 	}
 	else if ( isOption(arg, "c", "convert-tabs") )
 	{
-- 
1.9.0

